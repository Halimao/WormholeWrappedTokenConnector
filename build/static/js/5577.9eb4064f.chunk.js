/*! For license information please see 5577.9eb4064f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkwormhole_connector=self.webpackChunkwormhole_connector||[]).push([[5577],{5577:(e,t,r)=>{r.r(t),r.d(t,{BUTTON_POSITION:()=>wl,TORUS_BUILD_ENV:()=>ml,TorusInPageProvider:()=>Nl,default:()=>Fl});var n=r(9379),o=r(8951),i=r(9495),a=r(6218),s=r(600),l=r(7547),c=r(1200),u=(r(6118),{}),d={},f=m;m.default=m,m.stable=E,m.stableStringify=E;var h="[...]",p="[Circular]",g=[],b=[];function y(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function m(e,t,r,n){var o;typeof n>"u"&&(n=y()),_(e,"",0,[],void 0,0,n);try{o=0===b.length?JSON.stringify(e,t,r):JSON.stringify(e,A(t),r)}catch(a){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==g.length;){var i=g.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function w(e,t,r,n){var o=Object.getOwnPropertyDescriptor(n,r);void 0!==o.get?o.configurable?(Object.defineProperty(n,r,{value:e}),g.push([n,r,t,o])):b.push([t,r,e]):(n[r]=e,g.push([n,r,t]))}function _(e,t,r,n,o,i,a){var s;if(i+=1,"object"==typeof e&&null!==e){for(s=0;s<n.length;s++)if(n[s]===e)return void w(p,e,t,o);if(typeof a.depthLimit<"u"&&i>a.depthLimit)return void w(h,e,t,o);if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit)return void w(h,e,t,o);if(n.push(e),Array.isArray(e))for(s=0;s<e.length;s++)_(e[s],s,s,n,e,i,a);else{var l=Object.keys(e);for(s=0;s<l.length;s++){var c=l[s];_(e[c],c,s,n,e,i,a)}}n.pop()}}function v(e,t){return e<t?-1:e>t?1:0}function E(e,t,r,n){typeof n>"u"&&(n=y());var o,i=S(e,"",0,[],void 0,0,n)||e;try{o=0===b.length?JSON.stringify(i,t,r):JSON.stringify(i,A(t),r)}catch(s){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==g.length;){var a=g.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function S(e,t,r,n,o,i,a){var s;if(i+=1,"object"==typeof e&&null!==e){for(s=0;s<n.length;s++)if(n[s]===e)return void w(p,e,t,o);try{if("function"==typeof e.toJSON)return}catch(d){return}if(typeof a.depthLimit<"u"&&i>a.depthLimit)return void w(h,e,t,o);if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit)return void w(h,e,t,o);if(n.push(e),Array.isArray(e))for(s=0;s<e.length;s++)S(e[s],s,s,n,e,i,a);else{var l={},c=Object.keys(e).sort(v);for(s=0;s<c.length;s++){var u=c[s];S(e[u],u,s,n,e,i,a),l[u]=e[u]}if(!(typeof o<"u"))return l;g.push([o,t,e]),o[t]=l}n.pop()}}function A(e){return e=typeof e<"u"?e:function(e,t){return t},function(t,r){if(b.length>0)for(var n=0;n<b.length;n++){var o=b[n];if(o[1]===t&&o[0]===r){r=o[2],b.splice(n,1);break}}return e.call(this,t,r)}}const R=(0,l.g)(f);Object.defineProperty(d,"__esModule",{value:!0}),d.EthereumProviderError=d.EthereumRpcError=void 0;const I=f;class T extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return I.default(this.serialize(),x,2)}}d.EthereumRpcError=T;function x(e,t){if("[Circular]"!==t)return t}d.EthereumProviderError=class extends T{constructor(e,t,r){if(n=e,!(Number.isInteger(n)&&n>=1e3&&n<=4999))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');var n;super(e,t,r)}};var O={},P={};Object.defineProperty(P,"__esModule",{value:!0}),P.errorValues=P.errorCodes=void 0,P.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},P.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=P,r=d,n=t.errorCodes.rpc.internal,o={code:n,message:i(n)};function i(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unspecified error message. This is a bug, please report it.";if(Number.isInteger(r)){const n=r.toString();if(c(t.errorValues,n))return t.errorValues[n].message;if(s(r))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return n}function a(e){if(!Number.isInteger(e))return!1;const r=e.toString();return!(!t.errorValues[r]&&!s(e))}function s(e){return e>=-32099&&e<=-32e3}function l(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",e.getMessageFromCode=i,e.isValidCode=a,e.serializeError=function(e){let{fallbackError:t=o,shouldIncludeStack:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,u;if(!t||!Number.isInteger(t.code)||"string"!=typeof t.message)throw new Error("Must provide fallback error with integer number code and string message.");if(e instanceof r.EthereumRpcError)return e.serialize();const d={};if(e&&"object"==typeof e&&!Array.isArray(e)&&c(e,"code")&&a(e.code)){const t=e;d.code=t.code,t.message&&"string"==typeof t.message?(d.message=t.message,c(t,"data")&&(d.data=t.data)):(d.message=i(d.code),d.data={originalError:l(e)})}else{d.code=t.code;const r=null===(s=e)||void 0===s?void 0:s.message;d.message=r&&"string"==typeof r?r:t.message,d.data={originalError:l(e)}}const f=null===(u=e)||void 0===u?void 0:u.stack;return n&&e&&f&&"string"==typeof f&&(d.stack=f),d}}(O);var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.ethErrors=void 0;const j=d,L=O,N=P;function C(e,t){const[r,n]=M(t);return new j.EthereumRpcError(e,r||L.getMessageFromCode(e),n)}function B(e,t){const[r,n]=M(t);return new j.EthereumProviderError(e,r||L.getMessageFromCode(e),n)}function M(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}function W(e,t,r){return(t=U(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){W(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}k.ethErrors={rpc:{parse:e=>C(N.errorCodes.rpc.parse,e),invalidRequest:e=>C(N.errorCodes.rpc.invalidRequest,e),invalidParams:e=>C(N.errorCodes.rpc.invalidParams,e),methodNotFound:e=>C(N.errorCodes.rpc.methodNotFound,e),internal:e=>C(N.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return C(t,e)},invalidInput:e=>C(N.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>C(N.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>C(N.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>C(N.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>C(N.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>C(N.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>B(N.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>B(N.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>B(N.errorCodes.provider.unsupportedMethod,e),disconnected:e=>B(N.errorCodes.provider.disconnected,e),chainDisconnected:e=>B(N.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:n}=e;if(!r||"string"!=typeof r)throw new Error('"message" must be a nonempty string');return new j.EthereumProviderError(t,r,n)}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=d;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const r=O;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});const n=k;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const o=P;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return o.errorCodes}})}(u);var H={exports:{}},z={exports:{}};var V={AggregateError:class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got ".concat(typeof e));let t="";for(let r=0;r<e.length;r++)t+="    ".concat(e[r].stack,"\n");super(t),this.name="AggregateError",this.errors=e}},ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error:Error,FunctionPrototypeCall(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call(t,...n)},FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Boolean:Boolean,Uint8Array:Uint8Array},K={exports:{}},G={format(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.replace(/%([sdifj])/g,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o,i]=t;const a=r.shift();return"f"===i?a.toFixed(6):"j"===i?JSON.stringify(a):"s"===i&&"object"==typeof a?"".concat(a.constructor!==Object?a.constructor.name:""," {}").trim():a.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return'"'.concat(e,'"');if(!e.includes("`")&&!e.includes("${"))return"`".concat(e,"`")}return"'".concat(e,"'");case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return"".concat(String(e),"n");case"boolean":case"undefined":return String(e);case"object":return"{}"}}};const{format:J,inspect:Y}=G,{AggregateError:Z}=V,X=globalThis.AggregateError||Z,$=Symbol("kIsNodeError"),Q=["string","function","number","object","Function","Object","boolean","bigint","symbol"],ee=/^([A-Z][a-z0-9]*)+$/,te={};function re(e,t){if(!e)throw new te.ERR_INTERNAL_ASSERTION(t)}function ne(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function oe(e,t,r){r||(r=Error);class n extends r{constructor(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];super(function(e,t,r){if("function"==typeof t)return re(t.length<=r.length,"Code: ".concat(e,"; The provided arguments length (").concat(r.length,") does not match the required ones (").concat(t.length,").")),t(...r);const n=(t.match(/%[dfijoOs]/g)||[]).length;return re(n===r.length,"Code: ".concat(e,"; The provided arguments length (").concat(r.length,") does not match the required ones (").concat(n,").")),0===r.length?t:J(t,...r)}(e,t,n))}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[$]=!0,te[e]=n}function ie(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}let ae=class extends Error{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0!==t&&"object"!=typeof t)throw new te.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};oe("ERR_ASSERTION","%s",Error),oe("ERR_INVALID_ARG_TYPE",(e,t,r)=>{re("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+="".concat(e," "):n+='"'.concat(e,'" ').concat(e.includes(".")?"property":"argument"," "),n+="must be ";const o=[],i=[],a=[];for(const l of t)re("string"==typeof l,"All expected entries have to be of type string"),Q.includes(l)?o.push(l.toLowerCase()):ee.test(l)?i.push(l):(re("object"!==l,'The value "object" should be written as "Object"'),a.push(l));if(i.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),i.push("Object"))}if(o.length>0){switch(o.length){case 1:n+="of type ".concat(o[0]);break;case 2:n+="one of type ".concat(o[0]," or ").concat(o[1]);break;default:{const e=o.pop();n+="one of type ".concat(o.join(", "),", or ").concat(e)}}(i.length>0||a.length>0)&&(n+=" or ")}if(i.length>0){switch(i.length){case 1:n+="an instance of ".concat(i[0]);break;case 2:n+="an instance of ".concat(i[0]," or ").concat(i[1]);break;default:{const e=i.pop();n+="an instance of ".concat(i.join(", "),", or ").concat(e)}}a.length>0&&(n+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(n+="an "),n+="".concat(a[0]);break;case 2:n+="one of ".concat(a[0]," or ").concat(a[1]);break;default:{const e=a.pop();n+="one of ".concat(a.join(", "),", or ").concat(e)}}if(null==r)n+=". Received ".concat(r);else if("function"==typeof r&&r.name)n+=". Received function ".concat(r.name);else if("object"==typeof r){var s;if(null!==(s=r.constructor)&&void 0!==s&&s.name)n+=". Received an instance of ".concat(r.constructor.name);else{const e=Y(r,{depth:-1});n+=". Received ".concat(e)}}else{let e=Y(r,{colors:!1});e.length>25&&(e="".concat(e.slice(0,25),"...")),n+=". Received type ".concat(typeof r," (").concat(e,")")}return n},TypeError),oe("ERR_INVALID_ARG_VALUE",function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid",n=Y(t);return n.length>128&&(n=n.slice(0,128)+"..."),"The ".concat(e.includes(".")?"property":"argument"," '").concat(e,"' ").concat(r,". Received ").concat(n)},TypeError),oe("ERR_INVALID_RETURN_VALUE",(e,t,r)=>{var n;const o=null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?"instance of ".concat(r.constructor.name):"type ".concat(typeof r);return"Expected ".concat(e,' to be returned from the "').concat(t,'" function but got ').concat(o,".")},TypeError),oe("ERR_MISSING_ARGS",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n;re(t.length>0,"At least one arg needs to be specified");const o=t.length;switch(t=(Array.isArray(t)?t:[t]).map(e=>'"'.concat(e,'"')).join(" or "),o){case 1:n+="The ".concat(t[0]," argument");break;case 2:n+="The ".concat(t[0]," and ").concat(t[1]," arguments");break;default:{const e=t.pop();n+="The ".concat(t.join(", "),", and ").concat(e," arguments")}}return"".concat(n," must be specified")},TypeError),oe("ERR_OUT_OF_RANGE",(e,t,r)=>{let n;if(re(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>2**32)n=ne(String(r));else if("bigint"==typeof r){n=String(r);const e=BigInt(2)**BigInt(32);(r>e||r<-e)&&(n=ne(n)),n+="n"}else n=Y(r);return'The value of "'.concat(e,'" is out of range. It must be ').concat(t,". Received ").concat(n)},RangeError),oe("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),oe("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),oe("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),oe("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),oe("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),oe("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),oe("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),oe("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),oe("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),oe("ERR_STREAM_WRITE_AFTER_END","write after end",Error),oe("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var se,le={AbortError:ae,aggregateTwoErrors:ie(function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new X([t,e],t.message);return r.code=t.code,r}return e||t}),hideStackFrames:ie,codes:te},ce={exports:{}};function ue(){if(se)return ce.exports;se=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return ce.exports=e,ce.exports.AbortSignal=t,ce.exports.default=e,ce.exports}!function(e){const t=l.X,{format:r,inspect:n}=G,{codes:{ERR_INVALID_ARG_TYPE:o}}=le,{kResistStopPropagation:i,AggregateError:a,SymbolDispose:s}=V,u=globalThis.AbortSignal||ue().AbortSignal,d=globalThis.AbortController||ue().AbortController,f=Object.getPrototypeOf(async function(){}).constructor,h=globalThis.Blob||t.Blob,p=typeof h<"u"?function(e){return e instanceof h}:function(e){return!1},g=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new o(t,"AbortSignal",e)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}},promisify:e=>new Promise((t,r)=>{e(function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return e?r(e):t(...o)})}),debuglog:()=>function(){},format:r,inspect:n,types:{isAsyncFunction:e=>e instanceof f,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:p,deprecate:(e,t)=>e,addAbortListener:c.e.addAbortListener||function(e,t){if(void 0===e)throw new o("signal","AbortSignal",e);let r;return g(e,"signal"),((e,t)=>{if("function"!=typeof e)throw new o(t,"Function",e)})(t,"listener"),e.aborted?queueMicrotask(()=>t()):(e.addEventListener("abort",t,{__proto__:null,once:!0,[i]:!0}),r=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[s](){var e;null===(e=r)||void 0===e||e()}}},AbortSignalAny:u.any||function(e){if(1===e.length)return e[0];const t=new d,r=()=>t.abort();return e.forEach(e=>{g(e,"signals"),e.addEventListener("abort",r,{once:!0})}),t.signal.addEventListener("abort",()=>{e.forEach(e=>e.removeEventListener("abort",r))},{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(K);var de=K.exports,fe={};const{ArrayIsArray:he,ArrayPrototypeIncludes:pe,ArrayPrototypeJoin:ge,ArrayPrototypeMap:be,NumberIsInteger:ye,NumberIsNaN:me,NumberMAX_SAFE_INTEGER:we,NumberMIN_SAFE_INTEGER:_e,NumberParseInt:ve,ObjectPrototypeHasOwnProperty:Ee,RegExpPrototypeExec:Se,String:Ae,StringPrototypeToUpperCase:Re,StringPrototypeTrim:Ie}=V,{hideStackFrames:Te,codes:{ERR_SOCKET_BAD_PORT:xe,ERR_INVALID_ARG_TYPE:Oe,ERR_INVALID_ARG_VALUE:Pe,ERR_OUT_OF_RANGE:ke,ERR_UNKNOWN_SIGNAL:je}}=le,{normalizeEncoding:Le}=de,{isAsyncFunction:Ne,isArrayBufferView:Ce}=de.types,Be=Te(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:we;if("number"!=typeof e)throw new Oe(t,"number",e);if(!ye(e))throw new ke(t,"an integer",e);if(e<r||e>n)throw new ke(t,">= ".concat(r," && <= ").concat(n),e)});function Me(e,t,r){return null!=e&&Ee(e,t)?e[t]:r}Te(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-2147483648,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2147483647;if("number"!=typeof e)throw new Oe(t,"number",e);if(!ye(e))throw new ke(t,"an integer",e);if(e<r||e>n)throw new ke(t,">= ".concat(r," && <= ").concat(n),e)}),Te(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=typeof e)throw new Oe(t,"number",e);if(!ye(e))throw new ke(t,"an integer",e);const n=r?1:0,o=4294967295;if(e<n||e>o)throw new ke(t,">= ".concat(n," && <= ").concat(o),e)}),Te((e,t,r)=>{if(!pe(r,e)){const n="must be one of: "+ge(be(r,e=>"string"==typeof e?"'".concat(e,"'"):Ae(e)),", ");throw new Pe(t,e,n)}});const De=Te(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=Me(r,"allowArray",!1),o=Me(r,"allowFunction",!1);if(!Me(r,"nullable",!1)&&null===e||!n&&he(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new Oe(t,"Object",e)});Te((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new Oe(t,"a dictionary",e)}),Te(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!he(e))throw new Oe(t,"Array",e);if(e.length<r){const n="must be longer than ".concat(r);throw new Pe(t,e,n)}}),Te(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"buffer";if(!Ce(e))throw new Oe(t,["Buffer","TypedArray","DataView"],e)});const Ue=Te((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new Oe(t,"AbortSignal",e)}),We=Te((e,t)=>{if("function"!=typeof e)throw new Oe(t,"Function",e)});Te((e,t)=>{if("function"!=typeof e||Ne(e))throw new Oe(t,"Function",e)}),Te((e,t)=>{if(void 0!==e)throw new Oe(t,"undefined",e)});var Fe={validateBoolean:function(e,t){if("boolean"!=typeof e)throw new Oe(t,"boolean",e)},validateFunction:We,validateInteger:Be,validateObject:De,validateAbortSignal:Ue},qe={exports:{}};const{SymbolAsyncIterator:He,SymbolIterator:ze,SymbolFor:Ve}=V,Ke=Ve("nodejs.stream.destroyed"),Ge=Ve("nodejs.stream.errored"),Je=Ve("nodejs.stream.readable"),Ye=Ve("nodejs.stream.writable"),Ze=Ve("nodejs.stream.disturbed"),Xe=Ve("nodejs.webstream.isClosedPromise"),$e=Ve("nodejs.webstream.controllerErrorFunction");function Qe(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(r=e._readableState)||void 0===r?void 0:r.readable)||e._writableState&&!e._readableState)}function et(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function tt(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function rt(e){return!(!e||tt(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function nt(e){return!(!e||tt(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function ot(e){return!(!e||tt(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function it(e){if(!tt(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[Ke]||null!=n&&n.destroyed)}function at(e,t){if(!Qe(e))return null;const r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function st(e){return e&&null!=e[Je]?e[Je]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!it(e)&&(Qe(e)&&e.readable&&!at(e))}function lt(e){return e&&null!=e[Ye]?e[Ye]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!it(e)&&(et(e)&&e.writable&&!function(e){if(!et(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}(e))}function ct(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}var ut={isDestroyed:it,kIsDestroyed:Ke,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[Ze])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},isErrored:function(e){var t,r,n,o,i,a,s,l,c,u;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(o=null!==(i=null!==(a=e[Ge])&&void 0!==a?a:e.readableErrored)&&void 0!==i?i:e.writableErrored)&&void 0!==o?o:null===(s=e._readableState)||void 0===s?void 0:s.errorEmitted)&&void 0!==n?n:null===(l=e._writableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==r?r:null===(c=e._readableState)||void 0===c?void 0:c.errored)&&void 0!==t?t:null!==(u=e._writableState)&&void 0!==u&&u.errored))},isReadable:st,kIsClosedPromise:Xe,kControllerErrorFunction:$e,isClosed:function(e){if(!tt(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&ct(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return tt(e)?!!it(e)||!(!1!==(null==t?void 0:t.readable)&&st(e)||!1!==(null==t?void 0:t.writable)&&lt(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[He]:!1===t?"function"==typeof e[ze]:"function"==typeof e[He]||"function"==typeof e[ze])},isReadableNodeStream:Qe,isReadableStream:rt,isReadableFinished:at,isReadableErrored:function(e){var t,r;return tt(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:tt,isWebStream:function(e){return rt(e)||nt(e)||ot(e)},isWritable:lt,isWritableNodeStream:et,isWritableStream:nt,isWritableFinished:function(e,t){if(!et(e))return null;if(!0===e.writableFinished)return!0;const r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return tt(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},willEmitClose:function(e){if(!tt(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&function(e){return"boolean"==typeof e._sent100&&ct(e)}(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream:ot};const dt=l.dr,{AbortError:ft,codes:ht}=le,{ERR_INVALID_ARG_TYPE:pt,ERR_STREAM_PREMATURE_CLOSE:gt}=ht,{kEmptyObject:bt,once:yt}=de,{validateAbortSignal:mt,validateFunction:wt,validateObject:_t,validateBoolean:vt}=Fe,{Promise:Et,PromisePrototypeThen:St,SymbolDispose:At}=V,{isClosed:Rt,isReadable:It,isReadableNodeStream:Tt,isReadableStream:xt,isReadableFinished:Ot,isReadableErrored:Pt,isWritable:kt,isWritableNodeStream:jt,isWritableStream:Lt,isWritableFinished:Nt,isWritableErrored:Ct,isNodeStream:Bt,willEmitClose:Mt,kIsClosedPromise:Dt}=ut;let Ut;const Wt=()=>{};function Ft(e,t,r){var n,o;if(2===arguments.length?(r=t,t=bt):null==t?t=bt:_t(t,"options"),wt(r,"callback"),mt(t.signal,"options.signal"),r=yt(r),xt(e)||Lt(e))return function(e,t,r){let n=!1,o=Wt;if(t.signal)if(o=()=>{n=!0,r.call(e,new ft(void 0,{cause:t.signal.reason}))},t.signal.aborted)dt.nextTick(o);else{Ut=Ut||de.addAbortListener;const n=Ut(t.signal,o),i=r;r=yt(function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n[At](),i.apply(e,r)})}const i=function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];n||dt.nextTick(()=>r.apply(e,o))};return St(e[Dt].promise,i,i),Wt}(e,t,r);if(!Bt(e))throw new pt("stream",["ReadableStream","WritableStream","Stream"],e);const i=null!==(n=t.readable)&&void 0!==n?n:Tt(e),a=null!==(o=t.writable)&&void 0!==o?o:jt(e),s=e._writableState,l=e._readableState,c=()=>{e.writable||f()};let u=Mt(e)&&Tt(e)===i&&jt(e)===a,d=Nt(e,!1);const f=()=>{d=!0,e.destroyed&&(u=!1),(!u||e.readable&&!i)&&(!i||h)&&r.call(e)};let h=Ot(e,!1);const p=()=>{h=!0,e.destroyed&&(u=!1),(!u||e.writable&&!a)&&(!a||d)&&r.call(e)},g=t=>{r.call(e,t)};let b=Rt(e);const y=()=>{b=!0;const t=Ct(e)||Pt(e);return t&&"boolean"!=typeof t?r.call(e,t):i&&!h&&Tt(e,!0)&&!Ot(e,!1)?r.call(e,new gt):!a||d||Nt(e,!1)?void r.call(e):r.call(e,new gt)},m=()=>{b=!0;const t=Ct(e)||Pt(e);if(t&&"boolean"!=typeof t)return r.call(e,t);r.call(e)},w=()=>{e.req.on("finish",f)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?a&&!s&&(e.on("end",c),e.on("close",c)):(e.on("complete",f),u||e.on("abort",y),e.req?w():e.on("request",w)),!u&&"boolean"==typeof e.aborted&&e.on("aborted",y),e.on("end",p),e.on("finish",f),!1!==t.error&&e.on("error",g),e.on("close",y),b?dt.nextTick(y):null!=s&&s.errorEmitted||null!=l&&l.errorEmitted?u||dt.nextTick(m):(!i&&(!u||It(e))&&(d||!1===kt(e))||!a&&(!u||kt(e))&&(h||!1===It(e))||l&&e.req&&e.aborted)&&dt.nextTick(m);const _=()=>{r=Wt,e.removeListener("aborted",y),e.removeListener("complete",f),e.removeListener("abort",y),e.removeListener("request",w),e.req&&e.req.removeListener("finish",f),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",f),e.removeListener("end",p),e.removeListener("error",g),e.removeListener("close",y)};if(t.signal&&!b){const n=()=>{const n=r;_(),n.call(e,new ft(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)dt.nextTick(n);else{Ut=Ut||de.addAbortListener;const o=Ut(t.signal,n),i=r;r=yt(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];o[At](),i.apply(e,r)})}}return _}qe.exports=Ft,qe.exports.finished=function(e,t){var r;let n=!1;return null===t&&(t=bt),null!==(r=t)&&void 0!==r&&r.cleanup&&(vt(t.cleanup,"cleanup"),n=t.cleanup),new Et((r,o)=>{const i=Ft(e,t,e=>{n&&i(),e?o(e):r()})})};var qt=qe.exports;const Ht=l.dr,{aggregateTwoErrors:zt,codes:{ERR_MULTIPLE_CALLBACK:Vt},AbortError:Kt}=le,{Symbol:Gt}=V,{kIsDestroyed:Jt,isDestroyed:Yt,isFinished:Zt,isServerRequest:Xt}=ut,$t=Gt("kDestroy"),Qt=Gt("kConstruct");function er(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function tr(e,t,r){let n=!1;function o(t){if(n)return;n=!0;const o=e._readableState,i=e._writableState;er(t,i,o),i&&(i.closed=!0),o&&(o.closed=!0),"function"==typeof r&&r(t),t?Ht.nextTick(rr,e,t):Ht.nextTick(nr,e)}try{e._destroy(t||null,o)}catch(i){o(i)}}function rr(e,t){or(e,t),nr(e)}function nr(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function or(e,t){const r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function ir(e,t,r){const n=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=n&&n.destroyed)return this;null!=n&&n.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),n&&!n.errored&&(n.errored=t),r?Ht.nextTick(or,e,t):or(e,t))}function ar(e){let t=!1;function r(r){if(t)return void ir(e,null!==r&&void 0!==r?r:new Vt);t=!0;const n=e._readableState,o=e._writableState,i=o||n;n&&(n.constructed=!0),o&&(o.constructed=!0),i.destroyed?e.emit($t,r):r?ir(e,r,!0):Ht.nextTick(sr,e)}try{e._construct(e=>{Ht.nextTick(r,e)})}catch(n){Ht.nextTick(r,n)}}function sr(e){e.emit(Qt)}function lr(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function cr(e){e.emit("close")}function ur(e,t){e.emit("error",t),Ht.nextTick(cr,e)}var dr={construct:function(e,t){if("function"!=typeof e._construct)return;const r=e._readableState,n=e._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),e.once(Qt,t),!(e.listenerCount(Qt)>1)&&Ht.nextTick(ar,e)},destroyer:function(e,t){!e||Yt(e)||(!t&&!Zt(e)&&(t=new Kt),Xt(e)?(e.socket=null,e.destroy(t)):lr(e)?e.abort():lr(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?Ht.nextTick(ur,e,t):Ht.nextTick(cr,e),e.destroyed||(e[Jt]=!0))},destroy:function(e,t){const r=this._readableState,n=this._writableState,o=n||r;return null!=n&&n.destroyed||null!=r&&r.destroyed?("function"==typeof t&&t(),this):(er(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),o.constructed?tr(this,e,t):this.once($t,function(r){tr(this,zt(r,e),t)}),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:ir};const{ArrayIsArray:fr,ObjectSetPrototypeOf:hr}=V,{EventEmitter:pr}=c.e;function gr(e){pr.call(this,e)}function br(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?fr(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}hr(gr.prototype,pr.prototype),hr(gr,pr),gr.prototype.pipe=function(e,t){const r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",o),!e._isStdio&&(!t||!1!==t.end)&&(r.on("end",a),r.on("close",s));let i=!1;function a(){i||(i=!0,e.end())}function s(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){c(),0===pr.listenerCount(this,"error")&&this.emit("error",e)}function c(){r.removeListener("data",n),e.removeListener("drain",o),r.removeListener("end",a),r.removeListener("close",s),r.removeListener("error",l),e.removeListener("error",l),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return br(r,"error",l),br(e,"error",l),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var yr={Stream:gr,prependListener:br},mr={exports:{}};!function(e){const{SymbolDispose:t}=V,{AbortError:r,codes:n}=le,{isNodeStream:o,isWebStream:i,kControllerErrorFunction:a}=ut,s=qt,{ERR_INVALID_ARG_TYPE:l}=n;let c;e.exports.addAbortSignal=function(t,r){if(((e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new l(t,"AbortSignal",e)})(t,"signal"),!o(r)&&!i(r))throw new l("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,n){if("object"!=typeof e||!("aborted"in e))return n;const i=o(n)?()=>{n.destroy(new r(void 0,{cause:e.reason}))}:()=>{n[a](new r(void 0,{cause:e.reason}))};if(e.aborted)i();else{c=c||de.addAbortListener;const r=c(e,i);s(n,r[t])}return n}}(mr);var wr=mr.exports;const{StringPrototypeSlice:_r,SymbolIterator:vr,TypedArrayPrototypeSet:Er,Uint8Array:Sr}=V,{Buffer:Ar}=l.X,{inspect:Rr}=de;var Ir=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return Ar.alloc(0);const t=Ar.allocUnsafe(e>>>0);let r=this.head,n=0;for(;r;)Er(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[vr](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,n=0;do{const o=r.data;if(!(e>o.length)){e===o.length?(t+=o,++n,r.next?this.head=r.next:this.head=this.tail=null):(t+=_r(o,0,e),this.head=r,r.data=_r(o,e));break}t+=o,e-=o.length,++n}while(null!==(r=r.next));return this.length-=n,t}_getBuffer(e){const t=Ar.allocUnsafe(e),r=e;let n=this.head,o=0;do{const i=n.data;if(!(e>i.length)){e===i.length?(Er(t,i,r-e),++o,n.next?this.head=n.next:this.head=this.tail=null):(Er(t,new Sr(i.buffer,i.byteOffset,e),r-e),this.head=n,n.data=i.slice(e));break}Er(t,i,r-e),e-=i.length,++o}while(null!==(n=n.next));return this.length-=o,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return Rr(this,(0,n.A)((0,n.A)({},t),{},{depth:0,customInspect:!1}))}};const{MathFloor:Tr,NumberIsInteger:xr}=V,{validateInteger:Or}=Fe,{ERR_INVALID_ARG_VALUE:Pr}=le.codes;let kr=16384,jr=16;function Lr(e){return e?jr:kr}var Nr={getHighWaterMark:function(e,t,r,n){const o=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,n,r);if(null!=o){if(!xr(o)||o<0){const e=n?"options.".concat(r):"options.highWaterMark";throw new Pr(e,o)}return Tr(o)}return Lr(e.objectMode)},getDefaultHighWaterMark:Lr,setDefaultHighWaterMark:function(e,t){Or(t,"value",0),e?jr=t:kr=t}};const Cr=l.dr,{PromisePrototypeThen:Br,SymbolAsyncIterator:Mr,SymbolIterator:Dr}=V,{Buffer:Ur}=l.X,{ERR_INVALID_ARG_TYPE:Wr,ERR_STREAM_NULL_VALUES:Fr}=le.codes;var qr,Hr,zr,Vr,Kr,Gr,Jr,Yr,Zr=function(e,t,r){let o,i;if("string"==typeof t||t instanceof Ur)return new e((0,n.A)((0,n.A)({objectMode:!0},r),{},{read(){this.push(t),this.push(null)}}));if(t&&t[Mr])i=!0,o=t[Mr]();else{if(!t||!t[Dr])throw new Wr("iterable",["Iterable"],t);i=!1,o=t[Dr]()}const a=new e((0,n.A)({objectMode:!0,highWaterMark:1},r));let s=!1;return a._read=function(){s||(s=!0,async function(){for(;;){try{const{value:e,done:t}=i?await o.next():o.next();if(t)a.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw s=!1,new Fr;if(a.push(t))continue;s=!1}}catch(e){a.destroy(e)}break}}())},a._destroy=function(e,t){Br(async function(e){const t=null!=e,r="function"==typeof o.throw;if(t&&r){const{value:t,done:r}=await o.throw(e);if(await t,r)return}if("function"==typeof o.return){const{value:e}=await o.return();await e}}(e),()=>Cr.nextTick(t,e),r=>Cr.nextTick(t,r||e))},a};function Xr(){if(Hr)return qr;Hr=1;const e=l.dr,{ArrayPrototypeIndexOf:t,NumberIsInteger:r,NumberIsNaN:o,NumberParseInt:i,ObjectDefineProperties:u,ObjectKeys:d,ObjectSetPrototypeOf:f,Promise:h,SafeSet:p,SymbolAsyncDispose:g,SymbolAsyncIterator:b,Symbol:y}=V;qr=Z,Z.ReadableState=Y;const{EventEmitter:m}=c.e,{Stream:w,prependListener:_}=yr,{Buffer:v}=l.X,{addAbortSignal:E}=wr,S=qt;let A=de.debuglog("stream",e=>{A=e});const R=Ir,I=dr,{getHighWaterMark:T,getDefaultHighWaterMark:x}=Nr,{aggregateTwoErrors:O,codes:{ERR_INVALID_ARG_TYPE:P,ERR_METHOD_NOT_IMPLEMENTED:k,ERR_OUT_OF_RANGE:j,ERR_STREAM_PUSH_AFTER_EOF:L,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:N},AbortError:C}=le,{validateObject:B}=Fe,M=y("kPaused"),{StringDecoder:D}=(0,c.b)(),U=Zr;f(Z.prototype,w.prototype),f(Z,w);const W=()=>{},{errorOrDestroy:F}=I,q=1,H=16,z=32,K=2048,G=4096;function J(e){return{enumerable:!1,get(){return 0!==(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function Y(e,t,r){"boolean"!=typeof r&&(r=t instanceof en()),this.state=K|G|H|z,e&&e.objectMode&&(this.state|=q),r&&e&&e.readableObjectMode&&(this.state|=q),this.highWaterMark=e?T(this,e,"readableHighWaterMark",r):x(!1),this.buffer=new R,this.length=0,this.pipes=[],this.flowing=null,this[M]=null,e&&!1===e.emitClose&&(this.state&=-2049),e&&!1===e.autoDestroy&&(this.state&=-4097),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new D(e.encoding),this.encoding=e.encoding)}function Z(e){if(!(this instanceof Z))return new Z(e);const t=this instanceof en();this._readableState=new Y(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&E(e.signal,this)),w.call(this,e),I.construct(this,()=>{this._readableState.needReadable&&re(this,this._readableState)})}function X(e,t,r,n){A("readableAddChunk",t);const o=e._readableState;let i;if(o.state&q||("string"==typeof t?(r=r||o.defaultEncoding,o.encoding!==r&&(n&&o.encoding?t=v.from(t,r).toString(o.encoding):(t=v.from(t,r),r=""))):t instanceof v?r="":w._isUint8Array(t)?(t=w._uint8ArrayToBuffer(t),r=""):null!=t&&(i=new P("chunk",["string","Buffer","Uint8Array"],t))),i)F(e,i);else if(null===t)o.state&=-9,function(e,t){if(A("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?ee(e):(t.needReadable=!1,t.emittedReadable=!0,te(e))}}(e,o);else if(o.state&q||t&&t.length>0)if(n)if(4&o.state)F(e,new N);else{if(o.destroyed||o.errored)return!1;$(e,o,t,!0)}else if(o.ended)F(e,new L);else{if(o.destroyed||o.errored)return!1;o.state&=-9,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?$(e,o,t,!1):re(e,o)):$(e,o,t,!1)}else n||(o.state&=-9,re(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function $(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(65536&t.state?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),64&t.state&&ee(e)),re(e,t)}u(Y.prototype,{objectMode:J(q),ended:J(2),endEmitted:J(4),reading:J(8),constructed:J(H),sync:J(z),needReadable:J(64),emittedReadable:J(128),readableListening:J(256),resumeScheduled:J(512),errorEmitted:J(1024),emitClose:J(K),autoDestroy:J(G),destroyed:J(8192),closed:J(16384),closeEmitted:J(32768),multiAwaitDrain:J(65536),readingMore:J(1<<17),dataEmitted:J(1<<18)}),Z.prototype.destroy=I.destroy,Z.prototype._undestroy=I.undestroy,Z.prototype._destroy=function(e,t){t(e)},Z.prototype[m.captureRejectionSymbol]=function(e){this.destroy(e)},Z.prototype[g]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new C,this.destroy(e)),new h((t,r)=>S(this,n=>n&&n!==e?r(n):t(null)))},Z.prototype.push=function(e,t){return X(this,e,t,!1)},Z.prototype.unshift=function(e,t){return X(this,e,t,!0)},Z.prototype.isPaused=function(){const e=this._readableState;return!0===e[M]||!1===e.flowing},Z.prototype.setEncoding=function(e){const t=new D(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let n="";for(const o of r)n+=t.write(o);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this};function Q(e,t){return e<=0||0===t.length&&t.ended?0:t.state&q?1:o(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function ee(t){const r=t._readableState;A("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(A("emitReadable",r.flowing),r.emittedReadable=!0,e.nextTick(te,t))}function te(e){const t=e._readableState;A("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&!t.errored&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,se(e)}function re(t,r){!r.readingMore&&r.constructed&&(r.readingMore=!0,e.nextTick(ne,t,r))}function ne(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const r=t.length;if(A("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function oe(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[M]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function ie(e){A("readable nexttick read 0"),e.read(0)}function ae(e,t){A("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),se(e),t.flowing&&!t.reading&&e.read(0)}function se(e){const t=e._readableState;for(A("flow",t.flowing);t.flowing&&null!==e.read(););}function ce(e,t){"function"!=typeof e.read&&(e=Z.wrap(e,{objectMode:!0}));const r=function(e,t){return ue.apply(this,arguments)}(e,t);return r.stream=e,r}function ue(){return(ue=(0,s.A)(function*(e,t){let r,n=W;function o(t){this===e?(n(),n=W):n=t}e.on("readable",o);const i=S(e,{writable:!1},e=>{r=e?O(r,e):null,n(),n=W});try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(r)throw r;if(null===r)return;yield(0,a.A)(new h(o))}}}catch(s){throw r=O(r,s),r}finally{!r&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==r&&!e._readableState.autoDestroy?(e.off("readable",o),i()):I.destroyer(e,null)}})).apply(this,arguments)}function fe(e,t){if(0===t.length)return null;let r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function he(t){const r=t._readableState;A("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,e.nextTick(pe,r,t))}function pe(t,r){if(A("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length)if(t.endEmitted=!0,r.emit("end"),r.writable&&!1===r.allowHalfOpen)e.nextTick(ge,r);else if(t.autoDestroy){const e=r._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&r.destroy()}}function ge(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let be;function ye(){return void 0===be&&(be={}),be}return Z.prototype.read=function(e){A("read",e),void 0===e?e=NaN:r(e)||(e=i(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new j("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return A("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?he(this):ee(this),null;if(0===(e=Q(e,t))&&t.ended)return 0===t.length&&he(this),null;let o,a=0!==(64&t.state);if(A("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&(a=!0,A("length less than watermark",a)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)a=!1,A("reading, ended or constructing",a);else if(a){A("do read"),t.state|=8|z,0===t.length&&(t.state|=64);try{this._read(t.highWaterMark)}catch(s){F(this,s)}t.state&=-33,t.reading||(e=Q(n,t))}return o=e>0?fe(e,t):null,null===o?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&he(this)),null!==o&&!t.errorEmitted&&!t.closeEmitted&&(t.dataEmitted=!0,this.emit("data",o)),o},Z.prototype._read=function(e){throw new k("_read()")},Z.prototype.pipe=function(t,r){const n=this,o=this._readableState;1===o.pipes.length&&(o.multiAwaitDrain||(o.multiAwaitDrain=!0,o.awaitDrainWriters=new p(o.awaitDrainWriters?[o.awaitDrainWriters]:[]))),o.pipes.push(t),A("pipe count=%d opts=%j",o.pipes.length,r);const i=r&&!1===r.end||t===e.stdout||t===e.stderr?b:s;function a(e,r){A("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,A("cleanup"),t.removeListener("close",h),t.removeListener("finish",g),l&&t.removeListener("drain",l),t.removeListener("error",f),t.removeListener("unpipe",a),n.removeListener("end",s),n.removeListener("end",b),n.removeListener("data",d),c=!0,l&&o.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&l())}function s(){A("onend"),t.end()}o.endEmitted?e.nextTick(i):n.once("end",i),t.on("unpipe",a);let l,c=!1;function u(){c||(1===o.pipes.length&&o.pipes[0]===t?(A("false write response, pause",0),o.awaitDrainWriters=t,o.multiAwaitDrain=!1):o.pipes.length>1&&o.pipes.includes(t)&&(A("false write response, pause",o.awaitDrainWriters.size),o.awaitDrainWriters.add(t)),n.pause()),l||(l=function(e,t){return function(){const r=e._readableState;r.awaitDrainWriters===t?(A("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(A("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),(!r.awaitDrainWriters||0===r.awaitDrainWriters.size)&&e.listenerCount("data")&&e.resume()}}(n,t),t.on("drain",l))}function d(e){A("ondata");const r=t.write(e);A("dest.write",r),!1===r&&u()}function f(e){if(A("onerror",e),b(),t.removeListener("error",f),0===t.listenerCount("error")){const r=t._writableState||t._readableState;r&&!r.errorEmitted?F(t,e):t.emit("error",e)}}function h(){t.removeListener("finish",g),b()}function g(){A("onfinish"),t.removeListener("close",h),b()}function b(){A("unpipe"),n.unpipe(t)}return n.on("data",d),_(t,"error",f),t.once("close",h),t.once("finish",g),t.emit("pipe",n),!0===t.writableNeedDrain?u():o.flowing||(A("pipe resume"),n.resume()),t},Z.prototype.unpipe=function(e){const r=this._readableState;if(0===r.pipes.length)return this;if(!e){const e=r.pipes;r.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=t(r.pipes,e);return-1===n||(r.pipes.splice(n,1),0===r.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},Z.prototype.on=function(t,r){const n=w.prototype.on.call(this,t,r),o=this._readableState;return"data"===t?(o.readableListening=this.listenerCount("readable")>0,!1!==o.flowing&&this.resume()):"readable"===t&&!o.endEmitted&&!o.readableListening&&(o.readableListening=o.needReadable=!0,o.flowing=!1,o.emittedReadable=!1,A("on readable",o.length,o.reading),o.length?ee(this):o.reading||e.nextTick(ie,this)),n},Z.prototype.addListener=Z.prototype.on,Z.prototype.removeListener=function(t,r){const n=w.prototype.removeListener.call(this,t,r);return"readable"===t&&e.nextTick(oe,this),n},Z.prototype.off=Z.prototype.removeListener,Z.prototype.removeAllListeners=function(t){const r=w.prototype.removeAllListeners.apply(this,arguments);return("readable"===t||void 0===t)&&e.nextTick(oe,this),r},Z.prototype.resume=function(){const t=this._readableState;return t.flowing||(A("resume"),t.flowing=!t.readableListening,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(ae,t,r))}(this,t)),t[M]=!1,this},Z.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[M]=!0,this},Z.prototype.wrap=function(e){let t=!1;e.on("data",r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{F(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const r=d(e);for(let n=1;n<r.length;n++){const t=r[n];void 0===this[t]&&"function"==typeof e[t]&&(this[t]=e[t].bind(e))}return this},Z.prototype[b]=function(){return ce(this)},Z.prototype.iterator=function(e){return void 0!==e&&B(e,"options"),ce(this,e)},u(Z.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),u(Y.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[M]},set(e){this[M]=!!e}}}),Z._fromList=fe,Z.from=function(e,t){return U(Z,e,t)},Z.fromWeb=function(e,t){return ye().newStreamReadableFromReadableStream(e,t)},Z.toWeb=function(e,t){return ye().newReadableStreamFromStreamReadable(e,t)},Z.wrap=function(e,t){var r,o;return new Z((0,n.A)((0,n.A)({objectMode:null===(r=null!==(o=e.readableObjectMode)&&void 0!==o?o:e.objectMode)||void 0===r||r},t),{},{destroy(t,r){I.destroyer(e,t),r(t)}})).wrap(e)},qr}function $r(){if(Vr)return zr;Vr=1;const e=l.dr,{ArrayPrototypeSlice:t,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:o,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:s,Symbol:u,SymbolHasInstance:d}=V;zr=L,L.WritableState=k;const{EventEmitter:f}=c.e,h=yr.Stream,{Buffer:p}=l.X,g=dr,{addAbortSignal:b}=wr,{getHighWaterMark:y,getDefaultHighWaterMark:m}=Nr,{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:v,ERR_STREAM_CANNOT_PIPE:E,ERR_STREAM_DESTROYED:S,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:I,ERR_UNKNOWN_ENCODING:T}=le.codes,{errorOrDestroy:x}=g;function O(){}a(L.prototype,h.prototype),a(L,h);const P=u("kOnFinished");function k(e,t,r){"boolean"!=typeof r&&(r=t instanceof en()),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?y(this,e,"writableHighWaterMark",r):m(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const n=!(!e||!1!==e.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=M.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,j(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function j(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function L(e){const t=this instanceof en();if(!t&&!n(L,this))return new L(e);this._writableState=new k(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&b(e.signal,this)),h.call(this,e),g.construct(this,()=>{const e=this._writableState;e.writing||F(this,e),z(this,e)})}function N(t,r,n,o){const i=t._writableState;if("function"==typeof n)o=n,n=i.defaultEncoding;else{if(n){if("buffer"!==n&&!p.isEncoding(n))throw new T(n)}else n=i.defaultEncoding;"function"!=typeof o&&(o=O)}if(null===r)throw new R;if(!i.objectMode)if("string"==typeof r)!1!==i.decodeStrings&&(r=p.from(r,n),n="buffer");else if(r instanceof p)n="buffer";else{if(!h._isUint8Array(r))throw new w("chunk",["string","Buffer","Uint8Array"],r);r=h._uint8ArrayToBuffer(r),n="buffer"}let a;return i.ending?a=new I:i.destroyed&&(a=new S("write")),a?(e.nextTick(o,a),x(t,a,!0),a):(i.pendingcb++,function(e,t,r,n,o){const i=t.objectMode?1:r.length;t.length+=i;const a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:o}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&o!==O&&(t.allNoop=!1)):(t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),a&&!t.errored&&!t.destroyed}(t,i,r,n,o))}function C(e,t,r,n,o,i,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new S("write")):r?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function B(e,t,r,n){--t.pendingcb,n(r),W(t),x(e,r)}function M(t,r){const n=t._writableState,o=n.sync,i=n.writecb;"function"==typeof i?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,r?(r.stack,n.errored||(n.errored=r),t._readableState&&!t._readableState.errored&&(t._readableState.errored=r),o?e.nextTick(B,t,n,r,i):B(t,n,r,i)):(n.buffered.length>n.bufferedIndex&&F(t,n),o?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===i?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:i,stream:t,state:n},e.nextTick(D,n.afterWriteTickInfo)):U(t,n,1,i))):x(t,new v)}function D(e){let{stream:t,state:r,count:n,cb:o}=e;return r.afterWriteTickInfo=null,U(t,r,n,o)}function U(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&W(t),z(e,t)}function W(e){if(e.writing)return;for(let o=e.bufferedIndex;o<e.buffered.length;++o){var t;const{chunk:r,callback:n}=e.buffered[o],i=e.objectMode?1:r.length;e.length-=i,n(null!==(t=e.errored)&&void 0!==t?t:new S("write"))}const r=e[P].splice(0);for(let o=0;o<r.length;o++){var n;r[o](null!==(n=e.errored)&&void 0!==n?n:new S("end"))}j(e)}function F(e,r){if(r.corked||r.bufferProcessing||r.destroyed||!r.constructed)return;const{buffered:n,bufferedIndex:o,objectMode:i}=r,a=n.length-o;if(!a)return;let s=o;if(r.bufferProcessing=!0,a>1&&e._writev){r.pendingcb-=a-1;const o=r.allNoop?O:e=>{for(let t=s;t<n.length;++t)n[t].callback(e)},i=r.allNoop&&0===s?n:t(n,s);i.allBuffers=r.allBuffers,C(e,r,!0,r.length,i,"",o),j(r)}else{do{const{chunk:t,encoding:o,callback:a}=n[s];n[s++]=null;C(e,r,!1,i?1:t.length,t,o,a)}while(s<n.length&&!r.writing);s===n.length?j(r):s>256?(n.splice(0,s),r.bufferedIndex=0):r.bufferedIndex=s}r.bufferProcessing=!1}function q(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function H(t,r){!r.prefinished&&!r.finalCalled&&("function"!=typeof t._final||r.destroyed?(r.prefinished=!0,t.emit("prefinish")):(r.finalCalled=!0,function(t,r){let n=!1;function o(o){if(n)x(t,null!==o&&void 0!==o?o:v());else if(n=!0,r.pendingcb--,o){const e=r[P].splice(0);for(let t=0;t<e.length;t++)e[t](o);x(t,o,r.sync)}else q(r)&&(r.prefinished=!0,t.emit("prefinish"),r.pendingcb++,e.nextTick(K,t,r))}r.sync=!0,r.pendingcb++;try{t._final(o)}catch(i){o(i)}r.sync=!1}(t,r)))}function z(t,r,n){q(r)&&(H(t,r),0===r.pendingcb&&(n?(r.pendingcb++,e.nextTick((e,t)=>{q(t)?K(e,t):t.pendingcb--},t,r)):q(r)&&(r.pendingcb++,K(t,r))))}function K(e,t){t.pendingcb--,t.finished=!0;const r=t[P].splice(0);for(let n=0;n<r.length;n++)r[n]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),o(L,d,{__proto__:null,value:function(e){return!!n(this,e)||this===L&&(e&&e._writableState instanceof k)}}),L.prototype.pipe=function(){x(this,new E)},L.prototype.write=function(e,t,r){return!0===N(this,e,t,r)},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||F(this,e))},L.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=s(e)),!p.isEncoding(e))throw new T(e);return this._writableState.defaultEncoding=e,this},L.prototype._write=function(e,t,r){if(!this._writev)throw new _("_write()");this._writev([{chunk:e,encoding:t}],r)},L.prototype._writev=null,L.prototype.end=function(t,n,o){const i=this._writableState;let a;if("function"==typeof t?(o=t,t=null,n=null):"function"==typeof n&&(o=n,n=null),null!=t){const e=N(this,t,n);e instanceof r&&(a=e)}return i.corked&&(i.corked=1,this.uncork()),a||(i.errored||i.ending?i.finished?a=new A("end"):i.destroyed&&(a=new S("end")):(i.ending=!0,z(this,i,!0),i.ended=!0)),"function"==typeof o&&(a||i.finished?e.nextTick(o,a):i[P].push(o)),this},i(L.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const G=g.destroy;let J;function Y(){return void 0===J&&(J={}),J}return L.prototype.destroy=function(t,r){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[P].length)&&e.nextTick(W,n),G.call(this,t,r),this},L.prototype._undestroy=g.undestroy,L.prototype._destroy=function(e,t){t(e)},L.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},L.fromWeb=function(e,t){return Y().newStreamWritableFromWritableStream(e,t)},L.toWeb=function(e){return Y().newWritableStreamFromStreamWritable(e)},zr}function Qr(){if(Gr)return Kr;Gr=1;const e=l.dr,t=l.X,{isReadable:r,isWritable:n,isIterable:o,isNodeStream:i,isReadableNodeStream:c,isWritableNodeStream:u,isDuplexNodeStream:d,isReadableStream:f,isWritableStream:h}=ut,p=qt,{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:b,ERR_INVALID_RETURN_VALUE:y}}=le,{destroyer:m}=dr,w=en(),_=Xr(),v=$r(),{createDeferredPromise:E}=de,S=Zr,A=globalThis.Blob||t.Blob,R=typeof A<"u"?function(e){return e instanceof A}:function(e){return!1},I=globalThis.AbortController||ue().AbortController,{FunctionPrototypeCall:T}=V;class x extends w{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function O(e){const t=e.readable&&"function"!=typeof e.readable.read?_.wrap(e.readable):e.readable,o=e.writable;let i,a,s,l,c,u=!!r(t),d=!!n(o);function f(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new x({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==o||!o.writableObjectMode),readable:u,writable:d}),d&&(p(o,e=>{d=!1,e&&m(t,e),f(e)}),c._write=function(e,t,r){o.write(e,t)?r():i=r},c._final=function(e){o.end(),a=e},o.on("drain",function(){if(i){const e=i;i=null,e()}}),o.on("finish",function(){if(a){const e=a;a=null,e()}})),u&&(p(t,e=>{u=!1,e&&m(t,e),f(e)}),t.on("readable",function(){if(s){const e=s;s=null,e()}}),t.on("end",function(){c.push(null)}),c._read=function(){for(;;){const e=t.read();if(null===e)return void(s=c._read);if(!c.push(e))return}}),c._destroy=function(e,r){!e&&null!==l&&(e=new g),s=null,i=null,a=null,null===l?r(e):(l=r,m(o,e),m(t,e))},c}return Kr=function t(r,n){if(d(r))return r;if(c(r))return O({readable:r});if(u(r))return O({writable:r});if(i(r))return O({writable:!1,readable:!1});if(f(r))return O({readable:_.fromWeb(r)});if(h(r))return O({writable:v.fromWeb(r)});if("function"==typeof r){const{value:t,write:i,final:l,destroy:c}=function(t){let{promise:r,resolve:n}=E();const o=new I,i=o.signal;return{value:t((0,s.A)(function*(){for(;;){const t=r;r=null;const{chunk:o,done:s,cb:l}=yield(0,a.A)(t);if(e.nextTick(l),s)return;if(i.aborted)throw new g(void 0,{cause:i.reason});({promise:r,resolve:n}=E()),yield o}})(),{signal:i}),write(e,t,r){const o=n;n=null,o({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){o.abort(),t(e)}}}(r);if(o(t))return S(x,t,{objectMode:!0,write:i,final:l,destroy:c});const u=null==t?void 0:t.then;if("function"==typeof u){let r;const n=T(u,t,e=>{if(null!=e)throw new y("nully","body",e)},e=>{m(r,e)});return r=new x({objectMode:!0,readable:!1,write:i,final(t){l(async()=>{try{await n,e.nextTick(t,null)}catch(r){e.nextTick(t,r)}})},destroy:c})}throw new y("Iterable, AsyncIterable or AsyncFunction",n,t)}if(R(r))return t(r.arrayBuffer());if(o(r))return S(x,r,{objectMode:!0,writable:!1});if(f(null==r?void 0:r.readable)&&h(null==r?void 0:r.writable))return x.fromWeb(r);if("object"==typeof(null==r?void 0:r.writable)||"object"==typeof(null==r?void 0:r.readable)){return O({readable:null!=r&&r.readable?c(null==r?void 0:r.readable)?null==r?void 0:r.readable:t(r.readable):void 0,writable:null!=r&&r.writable?u(null==r?void 0:r.writable)?null==r?void 0:r.writable:t(r.writable):void 0})}const l=null==r?void 0:r.then;if("function"==typeof l){let e;return T(l,r,t=>{null!=t&&e.push(t),e.push(null)},t=>{m(e,t)}),e=new x({objectMode:!0,writable:!1,read(){}})}throw new b(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],r)}}function en(){if(Yr)return Jr;Yr=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:r,ObjectSetPrototypeOf:o}=V;Jr=s;const i=Xr(),a=$r();o(s.prototype,i.prototype),o(s,i);{const e=r(a.prototype);for(let t=0;t<e.length;t++){const r=e[t];s.prototype[r]||(s.prototype[r]=a.prototype[r])}}function s(e){if(!(this instanceof s))return new s(e);i.call(this,e),a.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let l,c;function u(){return void 0===l&&(l={}),l}return e(s.prototype,{writable:(0,n.A)({__proto__:null},t(a.prototype,"writable")),writableHighWaterMark:(0,n.A)({__proto__:null},t(a.prototype,"writableHighWaterMark")),writableObjectMode:(0,n.A)({__proto__:null},t(a.prototype,"writableObjectMode")),writableBuffer:(0,n.A)({__proto__:null},t(a.prototype,"writableBuffer")),writableLength:(0,n.A)({__proto__:null},t(a.prototype,"writableLength")),writableFinished:(0,n.A)({__proto__:null},t(a.prototype,"writableFinished")),writableCorked:(0,n.A)({__proto__:null},t(a.prototype,"writableCorked")),writableEnded:(0,n.A)({__proto__:null},t(a.prototype,"writableEnded")),writableNeedDrain:(0,n.A)({__proto__:null},t(a.prototype,"writableNeedDrain")),destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),s.fromWeb=function(e,t){return u().newStreamDuplexFromReadableWritablePair(e,t)},s.toWeb=function(e){return u().newReadableWritablePairFromDuplex(e)},s.from=function(e){return c||(c=Qr()),c(e,"body")},Jr}const{ObjectSetPrototypeOf:tn,Symbol:rn}=V;var nn=cn;const{ERR_METHOD_NOT_IMPLEMENTED:on}=le.codes,an=en(),{getHighWaterMark:sn}=Nr;tn(cn.prototype,an.prototype),tn(cn,an);const ln=rn("kCallback");function cn(e){if(!(this instanceof cn))return new cn(e);const t=e?sn(this,e,"readableHighWaterMark",!0):null;0===t&&(e=(0,n.A)((0,n.A)({},e),{},{highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0})),an.call(this,e),this._readableState.sync=!1,this[ln]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",dn)}function un(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,r)=>{t?e?e(t):this.destroy(t):(null!=r&&this.push(r),this.push(null),e&&e())})}function dn(){this._final!==un&&un.call(this)}cn.prototype._final=un,cn.prototype._transform=function(e,t,r){throw new on("_transform()")},cn.prototype._write=function(e,t,r){const n=this._readableState,o=this._writableState,i=n.length;this._transform(e,t,(e,t)=>{e?r(e):(null!=t&&this.push(t),o.ended||i===n.length||n.length<n.highWaterMark?r():this[ln]=r)})},cn.prototype._read=function(){if(this[ln]){const e=this[ln];this[ln]=null,e()}};const{ObjectSetPrototypeOf:fn}=V;var hn=gn;const pn=nn;function gn(e){if(!(this instanceof gn))return new gn(e);pn.call(this,e)}fn(gn.prototype,pn.prototype),fn(gn,pn),gn.prototype._transform=function(e,t,r){r(null,e)};const bn=l.dr,{ArrayIsArray:yn,Promise:mn,SymbolAsyncIterator:wn,SymbolDispose:_n}=V,vn=qt,{once:En}=de,Sn=dr,An=en(),{aggregateTwoErrors:Rn,codes:{ERR_INVALID_ARG_TYPE:In,ERR_INVALID_RETURN_VALUE:Tn,ERR_MISSING_ARGS:xn,ERR_STREAM_DESTROYED:On,ERR_STREAM_PREMATURE_CLOSE:Pn},AbortError:kn}=le,{validateFunction:jn,validateAbortSignal:Ln}=Fe,{isIterable:Nn,isReadable:Cn,isReadableNodeStream:Bn,isNodeStream:Mn,isTransformStream:Dn,isWebStream:Un,isReadableStream:Wn,isReadableFinished:Fn}=ut,qn=globalThis.AbortController||ue().AbortController;let Hn,zn,Vn;function Kn(e,t,r){let n=!1;e.on("close",()=>{n=!0});return{destroy:t=>{n||(n=!0,Sn.destroyer(e,t||new On("pipe")))},cleanup:vn(e,{readable:t,writable:r},e=>{n=!e})}}function Gn(e){if(Nn(e))return e;if(Bn(e))return function(e){return Jn.apply(this,arguments)}(e);throw new In("val",["Readable","Iterable","AsyncIterable"],e)}function Jn(){return(Jn=(0,s.A)(function*(e){zn||(zn=Xr()),yield*(0,o.A)((0,i.A)(zn.prototype[wn].call(e)),a.A)})).apply(this,arguments)}async function Yn(e,t,r,n){let o,{end:a}=n,s=null;const l=e=>{if(e&&(o=e),s){const e=s;s=null,e()}},c=()=>new mn((e,t)=>{o?t(o):s=()=>{o?t(o):e()}});t.on("drain",l);const u=vn(t,{readable:!1},l);try{t.writableNeedDrain&&await c();var d,f=!1,h=!1;try{for(var p,g=(0,i.A)(e);f=!(p=await g.next()).done;f=!1){const e=p.value;t.write(e)||await c()}}catch(b){h=!0,d=b}finally{try{f&&null!=g.return&&await g.return()}finally{if(h)throw d}}a&&(t.end(),await c()),r()}catch(y){r(o!==y?Rn(o,y):y)}finally{u(),t.off("drain",l)}}async function Zn(e,t,r,n){let{end:o}=n;Dn(t)&&(t=t.writable);const a=t.getWriter();try{var s,l=!1,c=!1;try{for(var u,d=(0,i.A)(e);l=!(u=await d.next()).done;l=!1){const e=u.value;await a.ready,a.write(e).catch(()=>{})}}catch(f){c=!0,s=f}finally{try{l&&null!=d.return&&await d.return()}finally{if(c)throw s}}await a.ready,o&&await a.close(),r()}catch(h){try{await a.abort(h),r(h)}catch(p){r(p)}}}function Xn(e,t,r){if(1===e.length&&yn(e[0])&&(e=e[0]),e.length<2)throw new xn("streams");const n=new qn,o=n.signal,i=null==r?void 0:r.signal,a=[];function s(){g(new kn)}let l,c,u;Ln(i,"options.signal"),Vn=Vn||de.addAbortListener,i&&(l=Vn(i,s));const d=[];let f,h=0;function p(e){g(e,0===--h)}function g(e,r){var o;if(e&&(!c||"ERR_STREAM_PREMATURE_CLOSE"===c.code)&&(c=e),c||r){for(;d.length;)d.shift()(c);null===(o=l)||void 0===o||o[_n](),n.abort(),r&&(c||a.forEach(e=>e()),bn.nextTick(t,c,u))}}for(let m=0;m<e.length;m++){const t=e[m],n=m<e.length-1,i=m>0,s=n||!1!==(null==r?void 0:r.end),l=m===e.length-1;if(Mn(t)){let e=function(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&p(e)};if(s){const{destroy:e,cleanup:r}=Kn(t,n,i);d.push(e),Cn(t)&&l&&a.push(r)}t.on("error",e),Cn(t)&&l&&a.push(()=>{t.removeListener("error",e)})}if(0===m)if("function"==typeof t){if(f=t({signal:o}),!Nn(f))throw new Tn("Iterable, AsyncIterable or Stream","source",f)}else f=Nn(t)||Bn(t)||Dn(t)?t:An.from(t);else if("function"==typeof t){var b;if(Dn(f))f=Gn(null===(b=f)||void 0===b?void 0:b.readable);else f=Gn(f);if(f=t(f,{signal:o}),n){if(!Nn(f,!0))throw new Tn("AsyncIterable","transform[".concat(m-1,"]"),f)}else{var y;Hn||(Hn=hn);const e=new Hn({objectMode:!0}),t=null===(y=f)||void 0===y?void 0:y.then;if("function"==typeof t)h++,t.call(f,t=>{u=t,null!=t&&e.write(t),s&&e.end(),bn.nextTick(p)},t=>{e.destroy(t),bn.nextTick(p,t)});else if(Nn(f,!0))h++,Yn(f,e,p,{end:s});else{if(!Wn(f)&&!Dn(f))throw new Tn("AsyncIterable or Promise","destination",f);{const t=f.readable||f;h++,Yn(t,e,p,{end:s})}}f=e;const{destroy:r,cleanup:n}=Kn(f,!1,!0);d.push(r),l&&a.push(n)}}else if(Mn(t)){if(Bn(f)){h+=2;const e=$n(f,t,p,{end:s});Cn(t)&&l&&a.push(e)}else if(Dn(f)||Wn(f)){const e=f.readable||f;h++,Yn(e,t,p,{end:s})}else{if(!Nn(f))throw new In("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],f);h++,Yn(f,t,p,{end:s})}f=t}else if(Un(t)){if(Bn(f))h++,Zn(Gn(f),t,p,{end:s});else if(Wn(f)||Nn(f))h++,Zn(f,t,p,{end:s});else{if(!Dn(f))throw new In("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],f);h++,Zn(f.readable,t,p,{end:s})}f=t}else f=An.from(t)}return(null!=o&&o.aborted||null!=i&&i.aborted)&&bn.nextTick(s),f}function $n(e,t,r,n){let{end:o}=n,i=!1;if(t.on("close",()=>{i||r(new Pn)}),e.pipe(t,{end:!1}),o){let r=function(){i=!0,t.end()};Fn(e)?bn.nextTick(r):e.once("end",r)}else r();return vn(e,{readable:!0,writable:!1},t=>{const n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)}),vn(t,{readable:!1,writable:!0},r)}var Qn={pipelineImpl:Xn,pipeline:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Xn(t,En(function(e){return jn(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(t)))}};const{pipeline:eo}=Qn,to=en(),{destroyer:ro}=dr,{isNodeStream:no,isReadable:oo,isWritable:io,isWebStream:ao,isTransformStream:so,isWritableStream:lo,isReadableStream:co}=ut,{AbortError:uo,codes:{ERR_INVALID_ARG_VALUE:fo,ERR_MISSING_ARGS:ho}}=le,po=qt;var go=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new ho("streams");if(1===t.length)return to.from(t[0]);const n=[...t];if("function"==typeof t[0]&&(t[0]=to.from(t[0])),"function"==typeof t[t.length-1]){const e=t.length-1;t[e]=to.from(t[e])}for(let h=0;h<t.length;++h)if(no(t[h])||ao(t[h])){if(h<t.length-1&&!(oo(t[h])||co(t[h])||so(t[h])))throw new fo("streams[".concat(h,"]"),n[h],"must be readable");if(h>0&&!(io(t[h])||lo(t[h])||so(t[h])))throw new fo("streams[".concat(h,"]"),n[h],"must be writable")}let o,i,a,s,l;const c=t[0],u=eo(t,function(e){const t=s;s=null,t?t(e):e?l.destroy(e):!f&&!d&&l.destroy()}),d=!!(io(c)||lo(c)||so(c)),f=!!(oo(u)||co(u)||so(u));if(l=new to({writableObjectMode:!(null==c||!c.writableObjectMode),readableObjectMode:!(null==u||!u.readableObjectMode),writable:d,readable:f}),d){if(no(c))l._write=function(e,t,r){c.write(e,t)?r():o=r},l._final=function(e){c.end(),i=e},c.on("drain",function(){if(o){const e=o;o=null,e()}});else if(ao(c)){const e=(so(c)?c.writable:c).getWriter();l._write=async function(t,r,n){try{await e.ready,e.write(t).catch(()=>{}),n()}catch(o){n(o)}},l._final=async function(t){try{await e.ready,e.close().catch(()=>{}),i=t}catch(r){t(r)}}}const e=so(u)?u.readable:u;po(e,()=>{if(i){const e=i;i=null,e()}})}if(f)if(no(u))u.on("readable",function(){if(a){const e=a;a=null,e()}}),u.on("end",function(){l.push(null)}),l._read=function(){for(;;){const e=u.read();if(null===e)return void(a=l._read);if(!l.push(e))return}};else if(ao(u)){const e=(so(u)?u.readable:u).getReader();l._read=async function(){for(;;)try{const{value:t,done:r}=await e.read();if(!l.push(t))return;if(r)return void l.push(null)}catch(t){return}}}return l._destroy=function(e,t){!e&&null!==s&&(e=new uo),a=null,o=null,i=null,null===s?t(e):(s=t,no(u)&&ro(u,e))},l};const bo=globalThis.AbortController||ue().AbortController,{codes:{ERR_INVALID_ARG_VALUE:yo,ERR_INVALID_ARG_TYPE:mo,ERR_MISSING_ARGS:wo,ERR_OUT_OF_RANGE:_o},AbortError:vo}=le,{validateAbortSignal:Eo,validateInteger:So,validateObject:Ao}=Fe,Ro=V.Symbol("kWeak"),Io=V.Symbol("kResistStopPropagation"),{finished:To}=qt,xo=go,{addAbortSignalNoValidate:Oo}=wr,{isWritable:Po,isNodeStream:ko}=ut,{deprecate:jo}=de,{ArrayPrototypePush:Lo,Boolean:No,MathFloor:Co,Number:Bo,NumberIsNaN:Mo,Promise:Do,PromiseReject:Uo,PromiseResolve:Wo,PromisePrototypeThen:Fo,Symbol:qo}=V,Ho=qo("kEmpty"),zo=qo("kEof");function Vo(e,t){if("function"!=typeof e)throw new mo("fn",["Function","AsyncFunction"],e);null!=t&&Ao(t,"options"),null!=(null==t?void 0:t.signal)&&Eo(t.signal,"options.signal");let r=1;null!=(null==t?void 0:t.concurrency)&&(r=Co(t.concurrency));let n=r-1;return null!=(null==t?void 0:t.highWaterMark)&&(n=Co(t.highWaterMark)),So(r,"options.concurrency",1),So(n,"options.highWaterMark",0),n+=r,(0,s.A)(function*(){const o=de.AbortSignalAny([null==t?void 0:t.signal].filter(No)),s=this,l=[],c={signal:o};let u,d,f=!1,h=0;function p(){f=!0,g()}function g(){h-=1,b()}function b(){d&&!f&&h<r&&l.length<n&&(d(),d=null)}!async function(){try{var t,a=!1,b=!1;try{for(var y,m=(0,i.A)(s);a=!(y=await m.next()).done;a=!1){let t=y.value;if(f)return;if(o.aborted)throw new vo;try{if(t=e(t,c),t===Ho)continue;t=Wo(t)}catch(w){t=Uo(w)}h+=1,Fo(t,g,p),l.push(t),u&&(u(),u=null),!f&&(l.length>=n||h>=r)&&await new Do(e=>{d=e})}}catch(_){b=!0,t=_}finally{try{a&&null!=m.return&&await m.return()}finally{if(b)throw t}}l.push(zo)}catch(v){const e=Uo(v);Fo(e,g,p),l.push(e)}finally{f=!0,u&&(u(),u=null)}}();try{for(;;){for(;l.length>0;){const e=yield(0,a.A)(l[0]);if(e===zo)return;if(o.aborted)throw new vo;e!==Ho&&(yield e),l.shift(),b()}yield(0,a.A)(new Do(e=>{u=e}))}}finally{f=!0,d&&(d(),d=null)}}).call(this)}async function Ko(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;var r,n=!1,o=!1;try{for(var a,s=(0,i.A)(Go.call(this,e,t));n=!(a=await s.next()).done;n=!1){a.value;return!0}}catch(l){o=!0,r=l}finally{try{n&&null!=s.return&&await s.return()}finally{if(o)throw r}}return!1}function Go(e,t){if("function"!=typeof e)throw new mo("fn",["Function","AsyncFunction"],e);return Vo.call(this,async function(t,r){return await e(t,r)?t:Ho},t)}class Jo extends wo{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function Yo(e){if(e=Bo(e),Mo(e))return 0;if(e<0)throw new _o("number",">= 0",e);return e}var Zo,Xo,$o;function Qo(){if(Xo)return Zo;Xo=1;const{ArrayPrototypePop:e,Promise:t}=V,{isIterable:r,isNodeStream:n,isWebStream:o}=ut,{pipelineImpl:i}=Qn,{finished:a}=qt;return ei(),Zo={finished:a,pipeline:function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return new t((t,a)=>{let l,c;const u=s[s.length-1];if(u&&"object"==typeof u&&!n(u)&&!r(u)&&!o(u)){const t=e(s);l=t.signal,c=t.end}i(s,(e,r)=>{e?a(e):t(r)},{signal:l,end:c})})}},Zo}function ei(){if($o)return z.exports;$o=1;const{Buffer:e}=l.X,{ObjectDefineProperty:t,ObjectKeys:r,ReflectApply:n}=V,{promisify:{custom:o}}=de,{streamReturningOperators:i,promiseReturningOperators:a}=fe,{codes:{ERR_ILLEGAL_CONSTRUCTOR:s}}=le,c=go,{setDefaultHighWaterMark:u,getDefaultHighWaterMark:d}=Nr,{pipeline:f}=Qn,{destroyer:h}=dr,p=qt,g=Qo(),b=ut,y=z.exports=yr.Stream;y.isDestroyed=b.isDestroyed,y.isDisturbed=b.isDisturbed,y.isErrored=b.isErrored,y.isReadable=b.isReadable,y.isWritable=b.isWritable,y.Readable=Xr();for(const l of r(i)){let e=function(){if(new.target)throw s();for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return y.Readable.from(n(r,this,t))};const r=i[l];t(e,"name",{__proto__:null,value:r.name}),t(e,"length",{__proto__:null,value:r.length}),t(y.Readable.prototype,l,{__proto__:null,value:e,enumerable:!1,configurable:!0,writable:!0})}for(const l of r(a)){let e=function(){if(new.target)throw s();for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n(r,this,t)};const r=a[l];t(e,"name",{__proto__:null,value:r.name}),t(e,"length",{__proto__:null,value:r.length}),t(y.Readable.prototype,l,{__proto__:null,value:e,enumerable:!1,configurable:!0,writable:!0})}y.Writable=$r(),y.Duplex=en(),y.Transform=nn,y.PassThrough=hn,y.pipeline=f;const{addAbortSignal:m}=wr;return y.addAbortSignal=m,y.finished=p,y.destroy=h,y.compose=c,y.setDefaultHighWaterMark=u,y.getDefaultHighWaterMark=d,t(y,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>g}),t(f,o,{__proto__:null,enumerable:!0,get:()=>g.pipeline}),t(p,o,{__proto__:null,enumerable:!0,get:()=>g.finished}),y.Stream=y,y._isUint8Array=function(e){return e instanceof Uint8Array},y._uint8ArrayToBuffer=function(t){return e.from(t.buffer,t.byteOffset,t.byteLength)},z.exports}fe.streamReturningOperators={asIndexedPairs:jo(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=e&&Ao(e,"options"),null!=(null==e?void 0:e.signal)&&Eo(e.signal,"options.signal"),(0,s.A)(function*(){let t=0;var r,n=!1,o=!1;try{for(var s,l=(0,i.A)(this);n=!(s=yield(0,a.A)(l.next())).done;n=!1){const r=s.value;var c;if(null!=e&&null!==(c=e.signal)&&void 0!==c&&c.aborted)throw new vo({cause:e.signal.reason});yield[t++,r]}}catch(u){o=!0,r=u}finally{try{n&&null!=l.return&&(yield(0,a.A)(l.return()))}finally{if(o)throw r}}}).call(this)},"readable.asIndexedPairs will be removed in a future version."),drop:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&Ao(t,"options"),null!=(null==t?void 0:t.signal)&&Eo(t.signal,"options.signal"),e=Yo(e),(0,s.A)(function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new vo;var n,o=!1,s=!1;try{for(var l,c=(0,i.A)(this);o=!(l=yield(0,a.A)(c.next())).done;o=!1){const r=l.value;var u;if(null!=t&&null!==(u=t.signal)&&void 0!==u&&u.aborted)throw new vo;e--<=0&&(yield r)}}catch(d){s=!0,n=d}finally{try{o&&null!=c.return&&(yield(0,a.A)(c.return()))}finally{if(s)throw n}}}).call(this)},filter:Go,flatMap:function(e,t){const r=Vo.call(this,e,t);return(0,s.A)(function*(){var e,t=!1,n=!1;try{for(var s,l=(0,i.A)(r);t=!(s=yield(0,a.A)(l.next())).done;t=!1){const e=s.value;yield*(0,o.A)((0,i.A)(e),a.A)}}catch(c){n=!0,e=c}finally{try{t&&null!=l.return&&(yield(0,a.A)(l.return()))}finally{if(n)throw e}}}).call(this)},map:Vo,take:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&Ao(t,"options"),null!=(null==t?void 0:t.signal)&&Eo(t.signal,"options.signal"),e=Yo(e),(0,s.A)(function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new vo;var n,o=!1,s=!1;try{for(var l,c=(0,i.A)(this);o=!(l=yield(0,a.A)(c.next())).done;o=!1){const r=l.value;var u;if(null!=t&&null!==(u=t.signal)&&void 0!==u&&u.aborted)throw new vo;if(e-- >0&&(yield r),e<=0)return}}catch(d){s=!0,n=d}finally{try{o&&null!=c.return&&(yield(0,a.A)(c.return()))}finally{if(s)throw n}}}).call(this)},compose:function(e,t){if(null!=t&&Ao(t,"options"),null!=(null==t?void 0:t.signal)&&Eo(t.signal,"options.signal"),ko(e)&&!Po(e))throw new yo("stream",e,"must be writable");const r=xo(this,e);return null!=t&&t.signal&&Oo(t.signal,r),r}},fe.promiseReturningOperators={every:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if("function"!=typeof e)throw new mo("fn",["Function","AsyncFunction"],e);return!await Ko.call(this,async function(){return!await e(...arguments)},t)},forEach:async function(e,t){if("function"!=typeof e)throw new mo("fn",["Function","AsyncFunction"],e);var r,n=!1,o=!1;try{for(var a,s=(0,i.A)(Vo.call(this,async function(t,r){return await e(t,r),Ho},t));n=!(a=await s.next()).done;n=!1){a.value}}catch(l){o=!0,r=l}finally{try{n&&null!=s.return&&await s.return()}finally{if(o)throw r}}},reduce:async function(e,t,r){var n;if("function"!=typeof e)throw new mo("reducer",["Function","AsyncFunction"],e);null!=r&&Ao(r,"options"),null!=(null==r?void 0:r.signal)&&Eo(r.signal,"options.signal");let o=arguments.length>1;if(null!=r&&null!==(n=r.signal)&&void 0!==n&&n.aborted){const e=new vo(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await To(this.destroy(e)),e}const a=new bo,s=a.signal;if(null!=r&&r.signal){const e={once:!0,[Ro]:this,[Io]:!0};r.signal.addEventListener("abort",()=>a.abort(),e)}let l=!1;try{var c,u=!1,d=!1;try{for(var f,h=(0,i.A)(this);u=!(f=await h.next()).done;u=!1){const n=f.value;var p;if(l=!0,null!=r&&null!==(p=r.signal)&&void 0!==p&&p.aborted)throw new vo;o?t=await e(t,n,{signal:s}):(t=n,o=!0)}}catch(g){d=!0,c=g}finally{try{u&&null!=h.return&&await h.return()}finally{if(d)throw c}}if(!l&&!o)throw new Jo}finally{a.abort()}return t},toArray:async function(e){null!=e&&Ao(e,"options"),null!=(null==e?void 0:e.signal)&&Eo(e.signal,"options.signal");const t=[];var r,n=!1,o=!1;try{for(var a,s=(0,i.A)(this);n=!(a=await s.next()).done;n=!1){const r=a.value;var l;if(null!=e&&null!==(l=e.signal)&&void 0!==l&&l.aborted)throw new vo(void 0,{cause:e.signal.reason});Lo(t,r)}}catch(c){o=!0,r=c}finally{try{n&&null!=s.return&&await s.return()}finally{if(o)throw r}}return t},some:Ko,find:async function(e,t){var r,n=!1,o=!1;try{for(var a,s=(0,i.A)(Go.call(this,e,t));n=!(a=await s.next()).done;n=!1){return a.value}}catch(l){o=!0,r=l}finally{try{n&&null!=s.return&&await s.return()}finally{if(o)throw r}}}},function(e){const t=ei(),r=Qo(),n=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=n,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get:()=>r}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(H);var ti=H.exports,ri={exports:{}},ni=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){n[e]=t[e]}),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),o=e[e.length-1];return"function"==typeof n&&n!==o&&Object.keys(o).forEach(function(e){n[e]=o[e]}),n}};var oi=ni;function ii(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function ai(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}ri.exports=oi(ii),ri.exports.strict=oi(ai),ii.proto=ii(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ii(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ai(this)},configurable:!0})});var si=ri.exports;const li=(0,l.g)(si);var ci=si,ui=function(){},di=function(e,t,r){if("function"==typeof t)return di(e,null,t);t||(t={}),r=ci(r||ui);var n=e._writableState,o=e._readableState,i=t.readable||!1!==t.readable&&e.readable,a=t.writable||!1!==t.writable&&e.writable,s=!1,c=function(){e.writable||u()},u=function(){a=!1,i||r.call(e)},d=function(){i=!1,a||r.call(e)},f=function(t){r.call(e,t?new Error("exited with error code: "+t):null)},h=function(t){r.call(e,t)},p=function(){l.d.process.nextTick(g)},g=function(){if(!s){if(i&&(!o||!o.ended||o.destroyed))return r.call(e,new Error("premature close"));if(a&&(!n||!n.ended||n.destroyed))return r.call(e,new Error("premature close"))}},b=function(){e.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(e)?(e.on("complete",u),e.on("abort",p),e.req?b():e.on("request",b)):a&&!n&&(e.on("end",c),e.on("close",c)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",f),e.on("end",d),e.on("finish",u),!1!==t.error&&e.on("error",h),e.on("close",p),function(){s=!0,e.removeListener("complete",u),e.removeListener("abort",p),e.removeListener("request",b),e.req&&e.req.removeListener("finish",u),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",u),e.removeListener("exit",f),e.removeListener("end",d),e.removeListener("error",h),e.removeListener("close",p)}},fi=di;const hi=(0,l.g)(fi);var pi,gi=si,bi=fi;try{pi=c.r}catch(ql){}var yi=function(){},mi=/^v?\.0/.test(l.d.process.version),wi=function(e){return"function"==typeof e},_i=function(e,t,r,n){n=gi(n);var o=!1;e.on("close",function(){o=!0}),bi(e,{readable:t,writable:r},function(e){if(e)return n(e);o=!0,n()});var i=!1;return function(t){if(!o&&!i){if(i=!0,function(e){return!(!mi||!pi)&&(e instanceof(pi.ReadStream||yi)||e instanceof(pi.WriteStream||yi))&&wi(e.close)}(e))return e.close(yi);if(function(e){return e.setHeader&&wi(e.abort)}(e))return e.abort();if(wi(e.destroy))return e.destroy();n(t||new Error("stream was destroyed"))}}},vi=function(e){e()},Ei=function(e,t){return e.pipe(t)},Si=function(){var e=Array.prototype.slice.call(arguments),t=wi(e[e.length-1]||yi)&&e.pop()||yi;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var r,n=e.map(function(o,i){var a=i<e.length-1;return _i(o,a,i>0,function(e){r||(r=e),e&&n.forEach(vi),!a&&(n.forEach(vi),t(r))})});return e.reduce(Ei)};const Ai=(0,l.g)(Si);function Ri(){}const Ii="ACK";class Ti extends ti.Duplex{constructor(e){let{name:t,target:r,targetWindow:n=window,targetOrigin:o="*"}=e;if(super({objectMode:!0}),W(this,"_init",void 0),W(this,"_haveSyn",void 0),W(this,"_name",void 0),W(this,"_target",void 0),W(this,"_targetWindow",void 0),W(this,"_targetOrigin",void 0),W(this,"_onMessage",void 0),W(this,"_synIntervalId",void 0),!t||!r)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=t,this._target=r,this._targetWindow=n,this._targetOrigin=o,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write("BRK",null,Ri),this._haveSyn=!1,this._init=!1}_handShake(){this._write("SYN",null,Ri),this.cork()}_onData(e){if(this._init)if("BRK"===e)this._break();else try{this.push(e)}catch(t){this.emit("error",t)}else"SYN"===e?(this._haveSyn=!0,this._write(Ii,null,Ri)):e===Ii&&(this._init=!0,this._haveSyn||this._write(Ii,null,Ri),this.uncork())}_postMessage(e){const t=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},t)}onMessage(e){const t=e.data;"*"!==this._targetOrigin&&e.origin!==this._targetOrigin||e.source!==this._targetWindow||"object"!=typeof t||t.target!==this._name||!t.data||this._onData(t.data)}_read(){}_write(e,t,r){this._postMessage(e),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}const xi={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},Oi=-32603;function Pi(e){return Number.isInteger(e)}function ki(e){return"string"==typeof e&&e.length>0}function ji(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function Li(e){const t=e;return!(!t||!Pi(t.code)||!ki(t.message)||t.stack&&!ki(t.stack))}const Ni={code:Oi,message:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unspecified error message. This is a bug, please report it.";if(Pi(e)){const t=e.toString();if(Object.hasOwn(xi,t))return xi[t].message}return t}(Oi)};function Ci(e){try{JSON.parse(JSON.stringify(e,(e,t)=>{if("__proto__"===e||"constructor"===e)throw new Error("Not valid json");if("function"==typeof t||"symbol"==typeof t)throw new Error("Not valid json");return t}),(e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t})}catch(t){return!1}return!0}function Bi(e){return Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return Ci(n)&&(t[r]=n),t},{})}function Mi(e,t){if(e&&"object"==typeof e&&"serialize"in e&&"function"==typeof e.serialize)return e.serialize();if(Li(e))return e;const r=function(e){return Array.isArray(e)?e.map(e=>Ci(e)?e:ji(e)?Bi(e):null):ji(e)?Bi(e):Ci(e)?e:null}(e);return q(q({},t),{},{data:{cause:r}})}function Di(e){let{fallbackError:t=Ni,shouldIncludeStack:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Li(t))throw new Error("Must provide fallback error with integer number code and string message.");const n=Mi(e,t);return r||delete n.stack,n}function Ui(e,t,r){try{Reflect.apply(e,t,r)}catch(n){setTimeout(()=>{throw n})}}class Wi extends c.e.EventEmitter{emit(e){let t="error"===e;const r=this._events;if(void 0!==r)t=t&&void 0===r.error;else if(!t)return!1;for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];if(t){let e;if(o.length>0&&([e]=o),e instanceof Error)throw e;const t=new Error("Unhandled error.".concat(e?" (".concat(e.message,")"):""));throw t.context=e,t}const a=r[e];if(void 0===a)return!1;if("function"==typeof a)Ui(a,this,o);else{const e=a.length,t=function(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(a);for(let r=0;r<e;r+=1)Ui(t[r],this,o)}return!0}}class Fi extends Error{constructor(e){let{code:t,message:r,data:n}=e;if(!Number.isInteger(t))throw new Error("code must be an integer");if(!r||"string"!=typeof r)throw new Error("message must be string");super(r),W(this,"code",void 0),W(this,"data",void 0),this.code=t,void 0!==n&&(this.data=n)}toString(){return R({code:this.code,message:this.message,data:this.data,stack:this.stack})}}const qi=function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n,o)=>{n||o.error?t(n||o.error):!r||Array.isArray(o)?e(o):e(o.result)}};function Hi(){const e={};const t=new Wi;const r=new ti.Duplex({objectMode:!0,read:function(){return!1},write:function(r,n,o){let i;try{r.id?function(t){const r=e[t.id];if(!r)throw new Error('StreamMiddleware - Unknown response id "'.concat(t.id,'"'));delete e[t.id],Object.assign(r.res,t),setTimeout(r.end)}(r):function(e){t.emit("notification",e)}(r)}catch(a){i=a}o(i)}});return{events:t,middleware:(t,n,o,i)=>{r.push(t),e[t.id]={req:t,res:n,next:o,end:i}},stream:r}}class zi extends Wi{constructor(){super(),W(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){const n=[];let o=null,i=!1;for(const a of r)if([o,i]=await zi._runMiddleware(e,t,a,n),i)break;return[o,i,n.reverse()]}static _runMiddleware(e,t,r,n){return new Promise(o=>{const i=e=>{const r=e||t.error;r&&("object"==typeof r&&!1===Object.keys(r).includes("stack")&&(r.stack="Stack trace is not available."),t.error=Di(r,{shouldIncludeStack:!0,fallbackError:{message:(null==r?void 0:r.message)||(null==r?void 0:r.toString()),code:(null==r?void 0:r.code)||-32603,stack:(null==r?void 0:r.stack)||"Stack trace is not available.",data:(null==r?void 0:r.data)||(null==r?void 0:r.message)||(null==r?void 0:r.toString())}})),o([r,!0])},a=e=>{t.error?i(t.error):(e&&("function"!=typeof e&&i(new Fi({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),n.push(e)),o([null,!1]))};try{r(e,t,a,i)}catch(s){i(s)}})}static async _runReturnHandlers(e){for(const t of e)await new Promise((e,r)=>{t(t=>t?r(t):e())})}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new Fi({code:-32603,message:"Response has no error or result for request"});if(!r)throw new Fi({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,n)=>{try{const[o,i,a]=await zi._runAllMiddleware(e,t,this._middleware);return i?(await zi._runReturnHandlers(a),n(o)):r(async e=>{try{await zi._runReturnHandlers(a)}catch(t){return e(t)}return e()})}catch(o){return n(o)}}}async _handleBatch(e,t){try{const r=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,r):r}catch(r){if(t)return t(r);throw r}}_promiseHandle(e){return new Promise((t,r)=>{this._handle(e,(e,n)=>{e&&void 0===n?r(e):t(n)}).catch(r)})}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const e=new Fi({code:-32603,message:"request must be plain object"});return t(e,{id:void 0,jsonrpc:"2.0",error:e})}if("string"!=typeof e.method){const r=new Fi({code:-32603,message:"method must be string"});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}const r=q({},e),n={id:r.id,jsonrpc:r.jsonrpc};let o=null;try{await this._processRequest(r,n)}catch(f){o=f}var i,a,s,l,c,u,d;o&&(delete n.result,!n.error)&&("object"==typeof o&&!1===Object.keys(o).includes("stack")&&(o.stack="Stack trace is not available."),n.error=Di(o,{shouldIncludeStack:!0,fallbackError:{message:(null===(i=o)||void 0===i?void 0:i.message)||(null===(a=o)||void 0===a?void 0:a.toString()),code:(null===(s=o)||void 0===s?void 0:s.code)||-32603,stack:(null===(l=o)||void 0===l?void 0:l.stack)||"Stack trace is not available.",data:(null===(c=o)||void 0===c?void 0:c.data)||(null===(u=o)||void 0===u?void 0:u.message)||(null===(d=o)||void 0===d?void 0:d.toString())}}));return t(o,n)}async _processRequest(e,t){const[r,n,o]=await zi._runAllMiddleware(e,t,this._middleware);if(zi._checkForCompletion(e,t,n),await zi._runReturnHandlers(o),r)throw r}}class Vi extends ti.Duplex{constructor(e){let{parent:t,name:r}=e;super({objectMode:!0}),W(this,"_parent",void 0),W(this,"_name",void 0),this._parent=t,this._name=r}_read(){}_write(e,t,r){this._parent.push({name:this._name,data:e}),r()}}const Ki=Symbol("IGNORE_SUBSTREAM");class Gi extends ti.Duplex{constructor(){super(q(q({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{objectMode:!0})),W(this,"_substreams",void 0),W(this,"getStream",void 0),this._substreams={}}createStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error('ObjectMultiplex - Substream for name "'.concat(e,'" already exists'));const t=new Vi({parent:this,name:e});return this._substreams[e]=t,function(e,t){const r=li(t);hi(e,{readable:!1},r),hi(e,{writable:!1},r)}(this,e=>t.destroy(e||void 0)),t}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error('ObjectMultiplex - Substream for name "'.concat(e,'" already exists'));this._substreams[e]=Ki}_read(){}_write(e,t,r){const{name:n,data:o}=e;if(!n)return window.console.warn('ObjectMultiplex - malformed chunk without name "'.concat(e,'"')),r();const i=this._substreams[n];return i?(i!==Ki&&i.push(o),r()):(window.console.warn('ObjectMultiplex - orphaned data for stream "'.concat(n,'"')),r())}}var Ji={exports:{}};!function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object Object]",s=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[o]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u[i]=u["[object Map]"]=u["[object Number]"]=u[a]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var d="object"==typeof l.U&&l.U&&l.U.Object===Object&&l.U,f="object"==typeof self&&self&&self.Object===Object&&self,h=d||f||Function("return this")(),p=t&&!t.nodeType&&t,g=p&&e&&!e.nodeType&&e,b=g&&g.exports===p,y=b&&d.process,m=function(){try{return g&&g.require&&g.require("util").types||y&&y.binding&&y.binding("util")}catch(e){}}(),w=m&&m.isTypedArray;var _=Array.prototype,v=Function.prototype,E=Object.prototype,S=h["__core-js_shared__"],A=v.toString,R=E.hasOwnProperty,I=function(){var e=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),T=E.toString,x=A.call(Object),O=RegExp("^"+A.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=b?h.Buffer:void 0,k=h.Symbol,j=h.Uint8Array;P&&P.allocUnsafe;var L,N,C=(L=Object.getPrototypeOf,N=Object,function(e){return L(N(e))}),B=Object.create,M=E.propertyIsEnumerable,D=_.splice,U=k?k.toStringTag:void 0,W=function(){try{var e=de(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),F=P?P.isBuffer:void 0,q=Math.max,H=Date.now,z=de(h,"Map"),V=de(Object,"create"),K=function(){function e(){}return function(t){if(!Se(t))return{};if(B)return B(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function G(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function J(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Z(e){var t=this.__data__=new J(e);this.size=t.size}function X(e,t){var r=me(e),n=!r&&ye(e),o=!r&&!n&&_e(e),i=!r&&!n&&!o&&Re(e),a=r||n||o||i,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||fe(c,l))||s.push(c);return s}function $(e,t,r){(void 0!==r&&!be(e[t],r)||void 0===r&&!(t in e))&&te(e,t,r)}function Q(e,t,r){var n=e[t];(!R.call(e,t)||!be(n,r)||void 0===r&&!(t in e))&&te(e,t,r)}function ee(e,t){for(var r=e.length;r--;)if(be(e[r][0],t))return r;return-1}function te(e,t,r){"__proto__"==t&&W?W(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}G.prototype.clear=function(){this.__data__=V?V(null):{},this.size=0},G.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G.prototype.get=function(e){var t=this.__data__;if(V){var n=t[e];return n===r?void 0:n}return R.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return V?void 0!==t[e]:R.call(t,e)},G.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=V&&void 0===t?r:t,this},J.prototype.clear=function(){this.__data__=[],this.size=0},J.prototype.delete=function(e){var t=this.__data__,r=ee(t,e);return!(r<0)&&(r==t.length-1?t.pop():D.call(t,r,1),--this.size,!0)},J.prototype.get=function(e){var t=this.__data__,r=ee(t,e);return r<0?void 0:t[r][1]},J.prototype.has=function(e){return ee(this.__data__,e)>-1},J.prototype.set=function(e,t){var r=this.__data__,n=ee(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(z||J),string:new G}},Y.prototype.delete=function(e){var t=ue(this,e).delete(e);return this.size-=t?1:0,t},Y.prototype.get=function(e){return ue(this,e).get(e)},Y.prototype.has=function(e){return ue(this,e).has(e)},Y.prototype.set=function(e,t){var r=ue(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Z.prototype.clear=function(){this.__data__=new J,this.size=0},Z.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,t){var r=this.__data__;if(r instanceof J){var n=r.__data__;if(!z||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(e,t),this.size=r.size,this};var re=function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var s=i[++n];if(!1===t(o[s],s,o))break}return e};function ne(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":U&&U in Object(e)?function(e){var t=R.call(e,U),r=e[U];try{e[U]=void 0;var n=!0}catch(i){}var o=T.call(e);return n&&(t?e[U]=r:delete e[U]),o}(e):function(e){return T.call(e)}(e)}function oe(e){return Ae(e)&&ne(e)==o}function ie(e){return!(!Se(e)||function(e){return!!I&&I in e}(e))&&(ve(e)?O:s).test(function(e){if(null!=e){try{return A.call(e)}catch(t){}try{return e+""}catch(r){}}return""}(e))}function ae(e){if(!Se(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=he(e),r=[];for(var n in e)"constructor"==n&&(t||!R.call(e,n))||r.push(n);return r}function se(e,t,r,n,o){e!==t&&re(t,function(i,s){if(o||(o=new Z),Se(i))!function(e,t,r,n,o,i,s){var l=pe(e,r),c=pe(t,r),u=s.get(c);if(u)return void $(e,r,u);var d=i?i(l,c,r+"",e,t,s):void 0,f=void 0===d;if(f){var h=me(c),p=!h&&_e(c),g=!h&&!p&&Re(c);d=c,h||p||g?me(l)?d=l:function(e){return Ae(e)&&we(e)}(l)?d=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(l):p?(f=!1,d=function(e){return e.slice()}(c)):g?(f=!1,d=function(e){var t=function(e){var t=new e.constructor(e.byteLength);return new j(t).set(new j(e)),t}(e.buffer);return new e.constructor(t,e.byteOffset,e.length)}(c)):d=[]:function(e){if(!Ae(e)||ne(e)!=a)return!1;var t=C(e);if(null===t)return!0;var r=R.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&A.call(r)==x}(c)||ye(c)?(d=l,ye(l)?d=function(e){return function(e,t,r){var n=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],s=void 0;void 0===s&&(s=e[a]),n?te(r,a,s):Q(r,a,s)}return r}(e,Ie(e))}(l):(!Se(l)||ve(l))&&(d=function(e){return"function"!=typeof e.constructor||he(e)?{}:K(C(e))}(c))):f=!1}f&&(s.set(c,d),o(d,c,n,i,s),s.delete(c)),$(e,r,d)}(e,t,s,r,se,n,o);else{var l=n?n(pe(e,s),i,s+"",e,t,o):void 0;void 0===l&&(l=i),$(e,s,l)}},Ie)}function le(e,t){return ge(function(e,t,r){return t=q(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=q(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,s)}}(e,t,Oe),e+"")}var ce=W?function(e,t){return W(e,"toString",{configurable:!0,enumerable:!1,value:xe(t),writable:!0})}:Oe;function ue(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function de(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return ie(r)?r:void 0}function fe(e,t){var r=typeof e;return!!(t=null!==t&&void 0!==t?t:n)&&("number"==r||"symbol"!=r&&c.test(e))&&e>-1&&e%1==0&&e<t}function he(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||E)}function pe(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ge=function(e){var t=0,r=0;return function(){var n=H(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ce);function be(e,t){return e===t||e!==e&&t!==t}var ye=oe(function(){return arguments}())?oe:function(e){return Ae(e)&&R.call(e,"callee")&&!M.call(e,"callee")},me=Array.isArray;function we(e){return null!=e&&Ee(e.length)&&!ve(e)}var _e=F||function(){return!1};function ve(e){if(!Se(e))return!1;var t=ne(e);return t==i||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ee(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function Se(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ae(e){return null!=e&&"object"==typeof e}var Re=w?function(e){return function(t){return e(t)}}(w):function(e){return Ae(e)&&Ee(e.length)&&!!u[ne(e)]};function Ie(e){return we(e)?X(e):ae(e)}var Te=function(e){return le(function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,r){if(!Se(r))return!1;var n=typeof t;return!!("number"==n?we(r)&&fe(t,r.length):"string"==n&&t in r)&&be(r[t],e)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t})}(function(e,t,r){se(e,t,r)});function xe(e){return function(){return e}}function Oe(e){return e}e.exports=Te}(Ji,Ji.exports);var Yi={exports:{}};!function(e){var t,r;t=l.U,r=function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],o={},i=null;function a(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(n){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(){for(var r=this.getLevel(),o=0;o<n.length;o++){var i=n[o];this[i]=o<r?e:this.methodFactory(i,r,this.name)}if(this.log=this.debug,typeof console===t&&r<this.levels.SILENT)return"No console available for logging"}function c(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function u(n,o,i){return function(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&r?s:void 0!==console[n]?a(console,n):void 0!==console.log?a(console,"log"):e)}(n)||c.apply(this,arguments)}function d(e,r){var a,s,c,d=this,f="loglevel";function h(){var e;if(typeof window!==t&&f){try{e=window.localStorage[f]}catch(i){}if(typeof e===t)try{var r=window.document.cookie,n=encodeURIComponent(f),o=r.indexOf(n+"=");-1!==o&&(e=/^([^;]+)/.exec(r.slice(o+n.length+1))[1])}catch(a){}return void 0===d.levels[e]&&(e=void 0),e}}function p(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?f+=":"+e:"symbol"==typeof e&&(f=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=r||u,d.getLevel=function(){var e;return null!==(e=null!==c&&void 0!==c?c:s)&&void 0!==e?e:a},d.setLevel=function(e,r){return c=p(e),!1!==r&&function(e){var r=(n[e]||"silent").toUpperCase();if(typeof window!==t&&f){try{return void(window.localStorage[f]=r)}catch(o){}try{window.document.cookie=encodeURIComponent(f)+"="+r+";"}catch(i){}}}(c),l.call(d)},d.setDefaultLevel=function(e){s=p(e),h()||d.setLevel(e,!1)},d.resetLevel=function(){c=null,function(){if(typeof window!==t&&f){try{window.localStorage.removeItem(f)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(r){}}}(),l.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(i!==d&&(a=p(i.getLevel())),l.call(d),i===d)for(var e in o)o[e].rebuild()},a=p(i?i.getLevel():"WARN");var g=h();null!=g&&(c=p(g)),l.call(d)}(i=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new d(e,i.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=f),i},i.getLoggers=function(){return o},i.default=i,i},e.exports?e.exports=r():t.log=r()}(Yi);var Zi=Yi.exports;const Xi=(0,l.g)(Zi);function $i(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, not ".concat(e))}function Qi(e){if(!function(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length ".concat(r,", not of length=").concat(e.length))}function ea(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}Xi.getLogger("http-helpers").setLevel(Zi.levels.INFO);const ta="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ra=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),na=(e,t)=>e<<32-t|e>>>t;function oa(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}(e)),Qi(e),e}new Uint8Array(new Uint32Array([287454020]).buffer)[0];class ia{clone(){return this._cloneInto()}}function aa(e){const t=t=>e().update(oa(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function sa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(ta&&"function"==typeof ta.getRandomValues)return ta.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}const la=(e,t,r)=>e&t^~e&r,ca=(e,t,r)=>e&t^e&r^t&r;class ua extends ia{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ra(this.buffer)}update(e){ea(this);const{view:t,buffer:r,blockLen:n}=this,o=(e=oa(e)).length;for(let i=0;i<o;){const a=Math.min(n-this.pos,o-i);if(a===n){const t=ra(e);for(;n<=o-i;i+=n)this.process(t,i);continue}r.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ea(this),function(e,t){Qi(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least ".concat(r))}(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(let u=i;u<n;u++)t[u]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const o=BigInt(32),i=BigInt(4294967295),a=Number(r>>o&i),s=Number(r&i),l=n?4:0,c=n?0:4;e.setUint32(t+l,a,n),e.setUint32(t+c,s,n)})(r,n-8,BigInt(8*this.length),o),this.process(r,0);const a=ra(e),s=this.outputLen;if(s%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=s/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,c[u],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:o,destroyed:i,pos:a}=this;return e.length=n,e.pos=a,e.finished=o,e.destroyed=i,n%t&&e.buffer.set(r),e}}const da=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),fa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ha=new Uint32Array(64);class pa extends ua{constructor(){super(64,32,8,!1),this.A=0|fa[0],this.B=0|fa[1],this.C=0|fa[2],this.D=0|fa[3],this.E=0|fa[4],this.F=0|fa[5],this.G=0|fa[6],this.H=0|fa[7]}get(){const{A:e,B:t,C:r,D:n,E:o,F:i,G:a,H:s}=this;return[e,t,r,n,o,i,a,s]}set(e,t,r,n,o,i,a,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|o,this.F=0|i,this.G=0|a,this.H=0|s}process(e,t){for(let u=0;u<16;u++,t+=4)ha[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=ha[u-15],t=ha[u-2],r=na(e,7)^na(e,18)^e>>>3,n=na(t,17)^na(t,19)^t>>>10;ha[u]=n+ha[u-7]+r+ha[u-16]|0}let{A:r,B:n,C:o,D:i,E:a,F:s,G:l,H:c}=this;for(let u=0;u<64;u++){const e=c+(na(a,6)^na(a,11)^na(a,25))+la(a,s,l)+da[u]+ha[u]|0,t=(na(r,2)^na(r,13)^na(r,22))+ca(r,n,o)|0;c=l,l=s,s=a,a=i+e|0,i=o,o=n,n=r,r=e+t|0}r=r+this.A|0,n=n+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,s=s+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(r,n,o,i,a,s,l,c)}roundClean(){ha.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ga=aa(()=>new pa);class ba extends ia{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");$i(e.outputLen),$i(e.blockLen)}(e);const r=oa(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?e.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=e.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(e){return ea(this),this.iHash.update(e),this}digestInto(e){ea(this),Qi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:o,blockLen:i,outputLen:a}=this;return e.finished=n,e.destroyed=o,e.blockLen=i,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ya=(e,t,r)=>new ba(e,t).update(r).digest();ya.create=(e,t)=>new ba(e,t);const ma=BigInt(0),wa=BigInt(1),_a=BigInt(2);function va(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function Ea(e){if(!va(e))throw new Error("Uint8Array expected")}const Sa=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Aa(e){Ea(e);let t="";for(let r=0;r<e.length;r++)t+=Sa[e[r]];return t}function Ra(e){const t=e.toString(16);return 1&t.length?"0".concat(t):t}function Ia(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x".concat(e))}const Ta=48,xa=57,Oa=65,Pa=70,ka=97,ja=102;function La(e){return e>=Ta&&e<=xa?e-Ta:e>=Oa&&e<=Pa?e-(Oa-10):e>=ka&&e<=ja?e-(ka-10):void 0}function Na(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){const t=La(e.charCodeAt(i)),r=La(e.charCodeAt(i+1));if(void 0===t||void 0===r){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[o]=16*t+r}return n}function Ca(e){return Ia(Aa(e))}function Ba(e){return Ea(e),Ia(Aa(Uint8Array.from(e).reverse()))}function Ma(e,t){return Na(e.toString(16).padStart(2*t,"0"))}function Da(e,t){return Ma(e,t).reverse()}function Ua(e,t,r){let n;if("string"==typeof t)try{n=Na(t)}catch(i){throw new Error("".concat(e,' must be valid hex string, got "').concat(t,'". Cause: ').concat(i))}else{if(!va(t))throw new Error("".concat(e," must be hex string or Uint8Array"));n=Uint8Array.from(t)}const o=n.length;if("number"==typeof r&&o!==r)throw new Error("".concat(e," expected ").concat(r," bytes, got ").concat(o));return n}function Wa(){let e=0;for(let r=0;r<arguments.length;r++){const t=r<0||arguments.length<=r?void 0:arguments[r];Ea(t),e+=t.length}const t=new Uint8Array(e);for(let r=0,n=0;r<arguments.length;r++){const e=r<0||arguments.length<=r?void 0:arguments[r];t.set(e,n),n+=e.length}return t}const Fa=e=>(_a<<BigInt(e-1))-wa,qa=e=>new Uint8Array(e),Ha=e=>Uint8Array.from(e);function za(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=qa(e),o=qa(e),i=0;const a=()=>{n.fill(1),o.fill(0),i=0},s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r(o,n,...t)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qa();o=s(Ha([0]),e),n=s(),0!==e.length&&(o=s(Ha([1]),e),n=s())},c=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=s();const t=n.slice();r.push(t),e+=n.length}return Wa(...r)};return(e,t)=>{let r;for(a(),l(e);!(r=t(c()));)l();return a(),r}}const Va={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||va(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Ka(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=(t,r,n)=>{const o=Va[r];if("function"!=typeof o)throw new Error('Invalid validator "'.concat(r,'", expected function'));const i=e[t];if((!n||void 0!==i)&&!o(i,e))throw new Error("Invalid param ".concat(String(t),"=").concat(i," (").concat(typeof i,"), expected ").concat(r))};for(const[o,i]of Object.entries(t))n(o,i,!1);for(const[o,i]of Object.entries(r))n(o,i,!0);return e}const Ga=Object.freeze(Object.defineProperty({__proto__:null,abytes:Ea,bitGet:function(e,t){return e>>BigInt(t)&wa},bitLen:function(e){let t;for(t=0;e>ma;e>>=wa,t+=1);return t},bitMask:Fa,bitSet:function(e,t,r){return e|(r?wa:ma)<<BigInt(t)},bytesToHex:Aa,bytesToNumberBE:Ca,bytesToNumberLE:Ba,concatBytes:Wa,createHmacDrbg:za,ensureBytes:Ua,equalBytes:function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},hexToBytes:Na,hexToNumber:Ia,isBytes:va,numberToBytesBE:Ma,numberToBytesLE:Da,numberToHexUnpadded:Ra,numberToVarBytesBE:function(e){return Na(Ra(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))},validateObject:Ka},Symbol.toStringTag,{value:"Module"})),Ja=BigInt(0),Ya=BigInt(1),Za=BigInt(2),Xa=BigInt(3),$a=BigInt(4),Qa=BigInt(5),es=BigInt(8);function ts(e,t){const r=e%t;return r>=Ja?r:t+r}function rs(e,t,r){if(r<=Ja||t<Ja)throw new Error("Expected power/modulo > 0");if(r===Ya)return Ja;let n=Ya;for(;t>Ja;)t&Ya&&(n=n*e%r),e=e*e%r,t>>=Ya;return n}function ns(e,t,r){let n=e;for(;t-- >Ja;)n*=n,n%=r;return n}function os(e,t){if(e===Ja||t<=Ja)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));let r=ts(e,t),n=t,o=Ja,i=Ya;for(;r!==Ja;){const e=n%r,t=o-i*(n/r);n=r,r=e,o=i,i=t}if(n!==Ya)throw new Error("invert: does not exist");return ts(o,t)}function is(e){if(e%$a===Xa){const t=(e+Ya)/$a;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%es===Qa){const t=(e-Qa)/es;return function(e,r){const n=e.mul(r,Za),o=e.pow(n,t),i=e.mul(r,o),a=e.mul(e.mul(i,Za),o),s=e.mul(i,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),r))throw new Error("Cannot find square root");return s}}return function(e){const t=(e-Ya)/Za;let r,n,o;for(r=e-Ya,n=0;r%Za===Ja;r/=Za,n++);for(o=Za;o<e&&rs(o,t,e)!==e-Ya;o++);if(1===n){const t=(e+Ya)/$a;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const i=(r+Ya)/Za;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let s=n,l=e.pow(e.mul(e.ONE,o),r),c=e.pow(a,i),u=e.pow(a,r);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(u);t<s&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const r=e.pow(l,Ya<<BigInt(s-t-1));l=e.sqr(r),c=e.mul(c,r),u=e.mul(u,l),s=t}return c}}(e)}BigInt(9),BigInt(16);const as=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ss(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function ls(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function cs(e){const t=ls(e);return t+Math.ceil(t/2)}const us=BigInt(0),ds=BigInt(1);function fs(e){return function(e){Ka(e,as.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),Ka(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,n.A)((0,n.A)((0,n.A)({},ss(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}const{bytesToNumberBE:hs,hexToBytes:ps}=Ga,gs={Err:class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},_parseInt(e){const{Err:t}=gs;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(128&n[0])throw new t("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:hs(n),l:e.subarray(r+2)}},toSig(e){const{Err:t}=gs,r="string"==typeof e?ps(e):e;Ea(r);let n=r.length;if(n<2||48!=r[0])throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=gs._parseInt(r.subarray(2)),{d:a,l:s}=gs._parseInt(i);if(s.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:a}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,r=e=>{const t=e.toString(16);return 1&t.length?"0".concat(t):t},n=t(r(e.s)),o=t(r(e.r)),i=n.length/2,a=o.length/2,s=r(i),l=r(a);return"30".concat(r(a+i+4),"02").concat(l).concat(o,"02").concat(s).concat(n)}},bs=BigInt(0),ys=BigInt(1);BigInt(2);const ms=BigInt(3);function ws(e){const t=function(e){const t=fs(e);Ka(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:o,a:i}=t;if(r){if(!o.eql(i,o.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze((0,n.A)({},t))}(e),{Fp:r}=t,o=t.toBytes||((e,t,n)=>{const o=t.toAffine();return Wa(Uint8Array.from([4]),r.toBytes(o.x),r.toBytes(o.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function a(e){const{a:n,b:o}=t,i=r.sqr(e),a=r.mul(i,e);return r.add(r.add(a,r.mul(e,n)),o)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&bs<e&&e<t.n}function l(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:o,n:i}=t;if(r&&"bigint"!=typeof e){if(va(e)&&(e=Aa(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*n,"0")}let a;try{a="bigint"==typeof e?e:Ca(Ua("private key",e,n))}catch(s){throw new Error("private key must be ".concat(n," bytes, hex or bigint, not ").concat(typeof e))}return o&&(a=ts(a,i)),l(a),a}const u=new Map;function d(e){if(!(e instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(e,t,n){if(this.px=e,this.py=t,this.pz=n,null==e||!r.isValid(e))throw new Error("x required");if(null==t||!r.isValid(t))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required")}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof f)throw new Error("projective point not allowed");const o=e=>r.eql(e,r.ZERO);return o(t)&&o(n)?f.ZERO:new f(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=r.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(f.fromAffine)}static fromHex(e){const t=f.fromAffine(i(Ua("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return f.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:n}=this.toAffine();if(!r.isValid(e)||!r.isValid(n))throw new Error("bad point: x or y not FE");const o=r.sqr(n),i=a(e);if(!r.eql(o,i))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){d(e);const{px:t,py:n,pz:o}=this,{px:i,py:a,pz:s}=e,l=r.eql(r.mul(t,s),r.mul(i,o)),c=r.eql(r.mul(n,s),r.mul(a,o));return l&&c}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,o=r.mul(n,ms),{px:i,py:a,pz:s}=this;let l=r.ZERO,c=r.ZERO,u=r.ZERO,d=r.mul(i,i),h=r.mul(a,a),p=r.mul(s,s),g=r.mul(i,a);return g=r.add(g,g),u=r.mul(i,s),u=r.add(u,u),l=r.mul(e,u),c=r.mul(o,p),c=r.add(l,c),l=r.sub(h,c),c=r.add(h,c),c=r.mul(l,c),l=r.mul(g,l),u=r.mul(o,u),p=r.mul(e,p),g=r.sub(d,p),g=r.mul(e,g),g=r.add(g,u),u=r.add(d,d),d=r.add(u,d),d=r.add(d,p),d=r.mul(d,g),c=r.add(c,d),p=r.mul(a,s),p=r.add(p,p),d=r.mul(p,g),l=r.sub(l,d),u=r.mul(p,h),u=r.add(u,u),u=r.add(u,u),new f(l,c,u)}add(e){d(e);const{px:n,py:o,pz:i}=this,{px:a,py:s,pz:l}=e;let c=r.ZERO,u=r.ZERO,h=r.ZERO;const p=t.a,g=r.mul(t.b,ms);let b=r.mul(n,a),y=r.mul(o,s),m=r.mul(i,l),w=r.add(n,o),_=r.add(a,s);w=r.mul(w,_),_=r.add(b,y),w=r.sub(w,_),_=r.add(n,i);let v=r.add(a,l);return _=r.mul(_,v),v=r.add(b,m),_=r.sub(_,v),v=r.add(o,i),c=r.add(s,l),v=r.mul(v,c),c=r.add(y,m),v=r.sub(v,c),h=r.mul(p,_),c=r.mul(g,m),h=r.add(c,h),c=r.sub(y,h),h=r.add(y,h),u=r.mul(c,h),y=r.add(b,b),y=r.add(y,b),m=r.mul(p,m),_=r.mul(g,_),y=r.add(y,m),m=r.sub(b,m),m=r.mul(p,m),_=r.add(_,m),b=r.mul(y,_),u=r.add(u,b),b=r.mul(v,_),c=r.mul(w,c),c=r.sub(c,b),b=r.mul(w,y),h=r.mul(v,h),h=r.add(h,b),new f(c,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(f.ZERO)}wNAF(e){return p.wNAFCached(this,u,e,e=>{const t=r.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(f.fromAffine)})}multiplyUnsafe(e){const n=f.ZERO;if(e===bs)return n;if(l(e),e===ys)return this;const{endo:o}=t;if(!o)return p.unsafeLadder(this,e);let{k1neg:i,k1:a,k2neg:s,k2:c}=o.splitScalar(e),u=n,d=n,h=this;for(;a>bs||c>bs;)a&ys&&(u=u.add(h)),c&ys&&(d=d.add(h)),h=h.double(),a>>=ys,c>>=ys;return i&&(u=u.negate()),s&&(d=d.negate()),d=new f(r.mul(d.px,o.beta),d.py,d.pz),u.add(d)}multiply(e){l(e);let n,o,i=e;const{endo:a}=t;if(a){const{k1neg:e,k1:t,k2neg:s,k2:l}=a.splitScalar(i);let{p:c,f:u}=this.wNAF(t),{p:d,f:h}=this.wNAF(l);c=p.constTimeNegate(e,c),d=p.constTimeNegate(s,d),d=new f(r.mul(d.px,a.beta),d.py,d.pz),n=c.add(d),o=u.add(h)}else{const{p:e,f:t}=this.wNAF(i);n=e,o=t}return f.normalizeZ([n,o])[0]}multiplyAndAddUnsafe(e,t,r){const n=f.BASE,o=(e,t)=>t!==bs&&t!==ys&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,r));return i.is0()?void 0:i}toAffine(e){const{px:t,py:n,pz:o}=this,i=this.is0();null==e&&(e=i?r.ONE:r.inv(o));const a=r.mul(t,e),s=r.mul(n,e),l=r.mul(o,e);if(i)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:a,y:s}}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===ys)return!0;if(r)return r(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===ys?this:r?r(f,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),o(f,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Aa(this.toRawBytes(e))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);const h=t.nBitLength,p=function(e,t){const r=(e,t)=>{const r=t.negate();return e?r:t},n=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:r,unsafeLadder(t,r){let n=e.ZERO,o=t;for(;r>us;)r&ds&&(n=n.add(o)),o=o.double(),r>>=ds;return n},precomputeWindow(e,t){const{windows:r,windowSize:o}=n(t),i=[];let a=e,s=a;for(let n=0;n<r;n++){s=a,i.push(s);for(let e=1;e<o;e++)s=s.add(a),i.push(s);a=s.double()}return i},wNAF(t,o,i){const{windows:a,windowSize:s}=n(t);let l=e.ZERO,c=e.BASE;const u=BigInt(2**t-1),d=2**t,f=BigInt(t);for(let e=0;e<a;e++){const t=e*s;let n=Number(i&u);i>>=f,n>s&&(n-=d,i+=ds);const a=t,h=t+Math.abs(n)-1,p=e%2!==0,g=n<0;0===n?c=c.add(r(p,o[a])):l=l.add(r(g,o[h]))}return{p:l,f:c}},wNAFCached(e,t,r,n){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,n(i))),this.wNAF(o,i,r)}}}(f,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:a,isWithinCurveOrder:s}}function _s(e){const t=function(e){const t=fs(e);return Ka(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,n.A)({lowS:!0},t))}(e),{Fp:r,n:o}=t,i=r.BYTES+1,a=2*r.BYTES+1;function s(e){return ts(e,o)}function l(e){return os(e,o)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:f}=ws((0,n.A)((0,n.A)({},t),{},{toBytes(e,t,n){const o=t.toAffine(),i=r.toBytes(o.x),a=Wa;return n?a(Uint8Array.from([t.hasEvenY()?2:3]),i):a(Uint8Array.from([4]),i,r.toBytes(o.y))},fromBytes(e){const t=e.length,n=e[0],o=e.subarray(1);if(t!==i||2!==n&&3!==n){if(t===a&&4===n){return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))}}throw new Error("Point of length ".concat(t," was invalid. Expected ").concat(i," compressed bytes or ").concat(a," uncompressed bytes"))}{const e=Ca(o);if(!function(e){return bs<e&&e<r.ORDER}(e))throw new Error("Point is not on curve");const t=d(e);let i;try{i=r.sqrt(t)}catch(s){const e=s instanceof Error?": "+s.message:"";throw new Error("Point is not on curve"+e)}return 1===(1&n)!==((i&ys)===ys)&&(i=r.neg(i)),{x:e,y:i}}}})),h=e=>Aa(Ma(e,t.nByteLength));function p(e){return e>o>>ys}const g=(e,t,r)=>Ca(e.slice(t,r));class b{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){const r=t.nByteLength;return e=Ua("compactSignature",e,2*r),new b(g(e,0,r),g(e,r,2*r))}static fromDER(e){const{r:t,s:r}=gs.toSig(Ua("DER",e));return new b(t,r)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new b(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:o,recovery:i}=this,a=_(Ua("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const u=2===i||3===i?n+t.n:n;if(u>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const d=1&i?"03":"02",f=c.fromHex(d+h(u)),p=l(u),g=s(-a*p),b=s(o*p),y=c.BASE.multiplyAndAddUnsafe(f,g,b);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Na(this.toDERHex())}toDERHex(){return gs.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Na(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const y={isValidPrivateKey(e){try{return u(e),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=cs(t.n);return function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.length,o=ls(t),i=cs(t);if(n<16||n<i||n>1024)throw new Error("expected ".concat(i,"-1024 bytes of input, got ").concat(n));const a=ts(r?Ca(e):Ba(e),t-Ya)+Ya;return r?Da(a,o):Ma(a,o)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function m(e){const t=va(e),r="string"==typeof e,n=(t||r)&&e.length;return t?n===i||n===a:r?n===2*i||n===2*a:e instanceof c}const w=t.bits2int||function(e){const r=Ca(e),n=8*e.length-t.nBitLength;return n>0?r>>BigInt(n):r},_=t.bits2int_modN||function(e){return s(w(e))},v=Fa(t.nBitLength);function E(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(bs<=e&&e<v))throw new Error("bigint expected < 2^".concat(t.nBitLength));return Ma(e,t.nByteLength)}function S(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;if(["recovered","canonical"].some(e=>e in o))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:a}=t;let{lowS:d,prehash:h,extraEntropy:g}=o;null==d&&(d=!0),e=Ua("msgHash",e),h&&(e=Ua("prehashed msgHash",i(e)));const y=_(e),m=u(n),v=[E(m),E(y)];if(null!=g&&!1!==g){const e=!0===g?a(r.BYTES):g;v.push(Ua("extraEntropy",e))}const S=Wa(...v),R=y;return{seed:S,k2sig:function(e){const t=w(e);if(!f(t))return;const r=l(t),n=c.BASE.multiply(t).toAffine(),o=s(n.x);if(o===bs)return;const i=s(r*s(R+o*m));if(i===bs)return;let a=(n.x===o?0:2)|Number(n.y&ys),u=i;return d&&p(i)&&(u=function(e){return p(e)?s(-e):e}(i),a^=1),new b(o,u,a)}}}const A={lowS:t.lowS,prehash:!1},R={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(m(e))throw new Error("first arg must be private key");if(!m(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;const{seed:o,k2sig:i}=S(e,r,n),a=t;return za(a.hash.outputLen,a.nByteLength,a.hmac)(o,i)},verify:function(e,r,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R;var i;const a=e;if(r=Ua("msgHash",r),n=Ua("publicKey",n),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:d}=o;let f,h;try{if("string"==typeof a||va(a))try{f=b.fromDER(a)}catch(S){if(!(S instanceof gs.Err))throw S;f=b.fromCompact(a)}else{if("object"!=typeof a||"bigint"!=typeof a.r||"bigint"!=typeof a.s)throw new Error("PARSE");{const{r:e,s:t}=a;f=new b(e,t)}}h=c.fromHex(n)}catch(S){if("PARSE"===S.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&f.hasHighS())return!1;d&&(r=t.hash(r));const{r:p,s:g}=f,y=_(r),m=l(g),w=s(y*m),v=s(p*m),E=null==(i=c.BASE.multiplyAndAddUnsafe(h,w,v))?void 0:i.toAffine();return!!E&&s(E.x)===p},ProjectivePoint:c,Signature:b,utils:y}}function vs(e){return{hash:e,hmac:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return ya(e,t,function(){let e=0;for(let r=0;r<arguments.length;r++){const t=r<0||arguments.length<=r?void 0:arguments[r];Qi(t),e+=t.length}const t=new Uint8Array(e);for(let r=0,n=0;r<arguments.length;r++){const e=r<0||arguments.length<=r?void 0:arguments[r];t.set(e,n),n+=e.length}return t}(...n))},randomBytes:sa}}BigInt(4);const Es=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ss=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),As=BigInt(1),Rs=BigInt(2),Is=(e,t)=>(e+t/Rs)/t;const Ts=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=Ja)throw new Error("Expected Field ORDER > 0, got ".concat(e));const{nBitLength:o,nByteLength:i}=ss(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const a=is(e),s=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:Fa(o),ZERO:Ja,ONE:Ya,create:t=>ts(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got ".concat(typeof t));return Ja<=t&&t<e},is0:e=>e===Ja,isOdd:e=>(e&Ya)===Ya,neg:t=>ts(-t,e),eql:(e,t)=>e===t,sqr:t=>ts(t*t,e),add:(t,r)=>ts(t+r,e),sub:(t,r)=>ts(t-r,e),mul:(t,r)=>ts(t*r,e),pow:(e,t)=>function(e,t,r){if(r<Ja)throw new Error("Expected power > 0");if(r===Ja)return e.ONE;if(r===Ya)return t;let n=e.ONE,o=t;for(;r>Ja;)r&Ya&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Ya;return n}(s,e,t),div:(t,r)=>ts(t*os(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>os(t,e),sqrt:n.sqrt||(e=>a(s,e)),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce((t,n,o)=>e.is0(n)?t:(r[o]=t,e.mul(t,n)),e.ONE),o=e.inv(n);return t.reduceRight((t,n,o)=>e.is0(n)?t:(r[o]=e.mul(t,r[o]),e.mul(t,n)),o),r}(s,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?Da(e,i):Ma(e,i),fromBytes:e=>{if(e.length!==i)throw new Error("Fp.fromBytes: expected ".concat(i,", got ").concat(e.length));return r?Ba(e):Ca(e)}});return Object.freeze(s)}(Es,void 0,void 0,{sqrt:function(e){const t=Es,r=BigInt(3),n=BigInt(6),o=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),l=BigInt(88),c=e*e*e%t,u=c*c*e%t,d=ns(u,r,t)*u%t,f=ns(d,r,t)*u%t,h=ns(f,Rs,t)*c%t,p=ns(h,o,t)*h%t,g=ns(p,i,t)*p%t,b=ns(g,s,t)*g%t,y=ns(b,l,t)*b%t,m=ns(y,s,t)*g%t,w=ns(m,r,t)*u%t,_=ns(w,a,t)*p%t,v=ns(_,n,t)*c%t,E=ns(v,Rs,t);if(!Ts.eql(Ts.sqr(E),e))throw new Error("Cannot find square root");return E}}),xs=function(e,t){const r=t=>_s((0,n.A)((0,n.A)({},e),vs(t)));return Object.freeze((0,n.A)((0,n.A)({},r(t)),{},{create:r}))}({a:BigInt(0),b:BigInt(7),Fp:Ts,n:Ss,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Ss,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-As*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,a=BigInt("0x100000000000000000000000000000000"),s=Is(i*e,t),l=Is(-n*e,t);let c=ts(e-s*r-l*o,t),u=ts(-s*n-l*i,t);const d=c>a,f=u>a;if(d&&(c=t-c),f&&(u=t-u),c>a||u>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:c,k2neg:f,k2:u}}}},ga);BigInt(0),xs.ProjectivePoint,BigInt(0);const Os={},Ps={};for(let Hl=0;Hl<16;Hl++){const e=Hl,t=16*Hl,r=Hl.toString(16).toLowerCase();Ps[r]=e,Ps[r.toUpperCase()]=e,Os[r]=t,Os[r.toUpperCase()]=t}Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));for(let Hl=0;Hl<=65535;Hl++)BigInt(Hl);const ks=e=>{if("string"!=typeof e)throw new Error("hex argument type ".concat(typeof e," must be of type string"));if(!/^0x[0-9a-fA-F]*$/.test(e))throw new Error("Input must be a 0x-prefixed hexadecimal string, got ".concat(e));const t=e.slice(2);return function(e){const t=e.length,r=new Uint8Array(t/2);for(let n=0;n<t;n+=2)r[n/2]=Os[e[n]]+Ps[e[n+1]];return r}(t.length%2===0?t:function(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received ".concat(typeof t));return t.length%2&&(t="0".concat(t)),t}(t))},js=e=>{const t=(e=>{if(!Number.isSafeInteger(e)||e<0)throw new Error("Received an invalid integer type: ".concat(e));return"0x".concat(e.toString(16))})(e);return ks(t)};BigInt("0xffffffffffffffff"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),xs.CURVE.n,xs.CURVE.n,BigInt(2),BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");ks("0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470");ks("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347");var Ls,Ns,Cs,Bs,Ms,Ds;ks("0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"),Uint8Array.from([128]),BigInt(-1),BigInt(0),BigInt(1),BigInt(2),BigInt(3),BigInt(7),BigInt(8),BigInt(27),BigInt(28),BigInt(31),BigInt(32),BigInt(64),BigInt(128),BigInt(255),BigInt(256),BigInt(96),BigInt(100),BigInt(160),BigInt(224),BigInt(7922816251426434e13),BigInt(1461501637330903e33),BigInt(2695994666715064e52),BigInt(1e9),Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),(Ns=Ls||(Ls={})).String="string",Ns.Bytes="view",Ns.Number="number",function(e){e.String="string",e.Bytes="view",e.JSON="json"}(Cs||(Cs={})),function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Uint8Array=2]="Uint8Array",e[e.PrefixedHexString=3]="PrefixedHexString"}(Bs||(Bs={})),function(e){e[e.Deposit=0]="Deposit",e[e.Withdrawal=1]="Withdrawal",e[e.Consolidation=2]="Consolidation"}(Ms||(Ms={})),function(e){e[e.Version=0]="Version",e[e.Balance=1]="Balance",e[e.Nonce=2]="Nonce",e[e.CodeHash=3]="CodeHash",e[e.CodeSize=4]="CodeSize"}(Ds||(Ds={})),js(Ds.Version),js(Ds.Balance),js(Ds.Nonce),js(Ds.CodeHash),js(Ds.CodeSize),BigInt(256),BigInt(31);var Us={},Ws={};Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.default=function(e){var t=e.length,r=t%4;if(!r)return e;var n=t,o=4-r,i=t+o,a=l.d.Buffer.alloc(i);for(a.write(e);o--;)a.write("=",n++);return a.toString()},Object.defineProperty(Us,"__esModule",{value:!0});var Fs=Ws;function qs(e,t){return void 0===t&&(t="utf8"),l.d.Buffer.isBuffer(e)?zs(e.toString("base64")):zs(l.d.Buffer.from(e,t).toString("base64"))}function Hs(e){return e=e.toString(),Fs.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function zs(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var Vs=qs;Vs.encode=qs,Vs.decode=function(e,t){return void 0===t&&(t="utf8"),l.d.Buffer.from(Hs(e),"base64").toString(t)},Vs.toBase64=Hs,Vs.fromBase64=zs,Vs.toBuffer=function(e){return l.d.Buffer.from(Hs(e),"base64")},Us.default=Vs,function(e){e.exports=Us.default,e.exports.default=e.exports}({exports:{}});const Ks={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},Gs={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"};function Js(e){let t,r=!1,n=0;try{t=window[e],r=!0,n=t.length;const o="__storage_test__";return t.setItem(o,o),t.removeItem(o),!0}catch(o){const e=o;return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&r&&0!==n}}class Ys{constructor(){W(this,"store",new Map)}getItem(e){return this.store.get(e)||null}setItem(e,t){this.store.set(e,t)}removeItem(e){this.store.delete(e)}}W(class{constructor(e,t){W(this,"storage",void 0),W(this,"_storeKey",void 0),this.storage=t,this._storeKey=e;try{t.getItem(e)||this.resetStore()}catch(r){}}static getInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if(!this.instanceMap.has(e)){let r;r="local"===t&&Js("localStorage")?window.localStorage:"session"===t&&Js("sessionStorage")?window.sessionStorage:new Ys,this.instanceMap.set(e,new this(e,r))}return this.instanceMap.get(e)}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.removeItem(this._storeKey),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(e){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[e]}set(e,t){const r=JSON.parse(this.storage.getItem(this._storeKey)||"{}");r[e]=t,this.storage.setItem(this._storeKey,JSON.stringify(r))}},"instanceMap",new Map),q(q({},Gs),Ks);const Zs="iframe_status",Xs="close_window",$s="user_logged_in",Qs="user_logged_out",el="logout",tl="wallet_instance_id",rl="user_info",nl="set_provider",ol="topup",il="iframe_status",al="closed_window",sl="get_provider_state",ll="wallet_get_provider_state",cl="wallet_accounts_changed",ul="wallet_chain_changed",dl="wallet_unlock_state_changed";var fl=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!==o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!==o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!==o--;){var a=i[o];if(!e(t[a],r[a]))return!1}return!0}return t!==t&&r!==r};const hl=(0,l.g)(fl);function pl(e){return null!==e&&"object"==typeof e&&"function"==typeof e.pipe}function gl(e){return function(e){return pl(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState}(e)&&function(e){return pl(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState}(e)}var bl={disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:e=>"Torus: The Torus Ethereum provider does not support synchronous methods like ".concat(e," without a callback parameter."),invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:e=>"Invalid options. Received: { maxEventListeners: ".concat(e,"}"),invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>"'args.logger' must include required method '".concat(e,"'.")},yl={connected:e=>'Torus: Connected to chain with ID "'.concat(e,'".')};const ml={PRODUCTION:"production"},wl={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"};var _l={translations:{en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies ben\xf6tigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"\u7d99\u7d9a\u3059\u308b",actionRequired:"\u8a8d\u8a3c\u304c\u5fc5\u8981\u3067\u3059",pendingAction:"\u7d9a\u884c\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u7d9a\u884c\u3057\u307e\u3059",cookiesRequired:"\u5fc5\u8981\u306a\u30af\u30c3\u30ad\u30fc",enableCookies:"Torus\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306b\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3067Cookie\u3092\u6709\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",clickHere:"\u8a73\u3057\u304f\u306f"}},ko:{embed:{continue:"\uacc4\uc18d\ud558\ub2e4",actionRequired:"\uc2b9\uc778 \ud544\uc694",pendingAction:"\ud31d\uc5c5\uc5d0\uc11c \uc694\uccad\uc744 \uc9c4\ud589\ud558\ub824\uba74 \uacc4\uc18d\uc744 \ud074\ub9ad\ud558\uc2ed\uc2dc\uc624.",cookiesRequired:"\ucfe0\ud0a4 \ud544\uc694",enableCookies:"\ube0c\ub77c\uc6b0\uc800 \ud658\uacbd \uc124\uc815\uc5d0\uc11c \ucfe0\ud0a4\ub97c \ud65c\uc131\ud654\ud558\uc5ec Torus\uc5d0 \uc561\uc138\uc2a4\ud558\uc2ed\uc2dc\uc624.",clickHere:"\ub354 \ub9ce\uc740 \uc815\ubcf4"}},zh:{embed:{continue:"\u7ee7\u7eed",actionRequired:"\u9700\u8981\u6388\u6743",pendingAction:"\u5355\u51fb\u7ee7\u7eed\u4ee5\u5728\u5f39\u51fa\u7a97\u53e3\u4e2d\u7ee7\u7eed\u60a8\u7684\u8bf7\u6c42",cookiesRequired:"\u5fc5\u586bCookie",enableCookies:"\u8bf7\u5728\u60a8\u7684\u6d4f\u89c8\u5668\u9996\u9009\u9879\u4e2d\u542f\u7528cookie\u4ee5\u8bbf\u95eeTorus\u3002",clickHere:"\u66f4\u591a\u4fe1\u606f"}}},localStorageKeyPrefix:"torus-"},vl=Xi.getLogger("solana-embed");const El=()=>Math.random().toString(36).slice(2),Sl=async e=>{let t,r;switch(e){case"testing":t="https://solana-testing.tor.us",r="debug";break;case"development":t="http://localhost:8080",r="debug";break;default:t="https://solana.tor.us",r="error"}return{torusUrl:t,logLevel:r}},Al={height:660,width:375},Rl={height:740,width:1315},Il={height:700,width:1200},Tl={height:600,width:400};function xl(e){let{width:t,height:r}=e;const n=void 0!==window.screenLeft?window.screenLeft:window.screenX,o=void 0!==window.screenTop?window.screenTop:window.screenY,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=Math.abs((i-t)/2/1+n),l=Math.abs((a-r)/2/1+o);return"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(r/1,",width=").concat(t/1,",top=").concat(l,",left=").concat(s)}class Ol extends Wi{constructor(e,t){let{maxEventListeners:r=100,jsonRpcStreamName:n="provider"}=t;if(super(),W(this,"isTorus",void 0),W(this,"_rpcEngine",void 0),W(this,"jsonRpcConnectionEvents",void 0),W(this,"_state",void 0),!gl(e))throw new Error(bl.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(r),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);const o=new Gi;Ai(e,o,e,this._handleStreamDisconnect.bind(this,"Torus")),o.ignoreStream("phishing");const i=Hi();Ai(i.stream,o.createStream(n),i.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));const a=new zi;a.push((e,t,r,n)=>{const o=e.id,i=Math.random().toString(36).slice(2);e.id=i,t.id=i,r(r=>{e.id=o,t.id=o,r()})}),a.push((e,t,r)=>{("string"!=typeof e.method||!e.method)&&(t.error=u.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r(e=>{const{error:r}=t;return r&&vl.error("Torus - RPC Error: ".concat(r.message),r),e()})}),a.push(function(e){return function(t,r,n){n(n=>{r.error&&Xi.warn("Error in RPC response:\n",r),!t.isTorusInternal&&(Xi.info("RPC (".concat(e.origin,"):"),t,"->",r),n())})}}({origin:location.origin})),a.push(i.middleware),this._rpcEngine=a,this.jsonRpcConnectionEvents=i.events}async request(e){if(!e||"object"!=typeof e||Array.isArray(e))throw u.ethErrors.rpc.invalidRequest({message:bl.invalidRequestArgs(),data:e});const{method:t,params:r}=e;if("string"!=typeof t||0===t.length)throw u.ethErrors.rpc.invalidRequest({message:bl.invalidRequestMethod(),data:e});if(void 0!==r&&!Array.isArray(r)&&("object"!=typeof r||null===r))throw u.ethErrors.rpc.invalidRequest({message:bl.invalidRequestParams(),data:e});return new Promise((e,n)=>{this._rpcRequest({method:t,params:r},qi(e,n))})}send(e,t){this._rpcRequest(e,t)}sendAsync(e){return new Promise((t,r)=>{this._rpcRequest(e,qi(t,r))})}_handleStreamDisconnect(e,t){(function(e,t,r){let n='Torus: Lost connection to "'.concat(e,'".');null!=t&&t.stack&&(n+="\n".concat(t.stack)),vl.warn(n),r&&r.listenerCount("error")>0&&r.emit("error",n)})(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}}const Pl=e=>{const t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild};function kl(e){return void 0===e.version}class jl extends Wi{constructor(e){let{url:t,target:r,features:n,timeout:o=3e4}=e;super(),W(this,"url",void 0),W(this,"target",void 0),W(this,"features",void 0),W(this,"window",void 0),W(this,"windowTimer",void 0),W(this,"iClosedWindow",void 0),W(this,"timeout",void 0),this.url=t,this.target=r||"_blank",this.features=n||xl(Il),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=o,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){var e;return this.window=window.open(this.url.href,this.target,this.features),null!=(e=this.window)&&e.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}class Ll extends Ol{constructor(e,t){let{maxEventListeners:r=100,jsonRpcStreamName:n="provider"}=t;super(e,{maxEventListeners:r,jsonRpcStreamName:n}),W(this,"embedTranslations",void 0),W(this,"torusUrl",void 0),W(this,"dappStorageKey",void 0),W(this,"windowRefs",void 0),W(this,"tryWindowHandle",void 0),W(this,"torusAlertContainer",void 0),W(this,"torusIframe",void 0),this._state=q({},Ll._defaultState),this.torusUrl="",this.dappStorageKey="";const o=_l.translations[(()=>{let e=window.navigator.language||"en-US";const t=e.split("-");return e=Object.prototype.hasOwnProperty.call(_l.translations,t[0])?t[0]:"en",e})()];this.embedTranslations=o.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0});this.jsonRpcConnectionEvents.on("notification",e=>{const{method:t,params:r}=e;if(t===Zs){const{isFullScreen:e,rid:t}=r;this._displayIframe({isFull:e,rid:t})}else if("create_window"===t){const{windowId:e,url:t}=r;this._createPopupBlockAlert(e,t)}else if(t===Xs)this._handleCloseWindow(r);else if(t===$s){const{currentLoginProvider:e}=r;this._state.isLoggedIn=!0,this._state.currentLoginProvider=e}else t===Qs&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())})}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(e){try{const{torusUrl:t,dappStorageKey:r,torusAlertContainer:n,torusIframe:o}=e;this.torusUrl=t,this.dappStorageKey=r,this.torusAlertContainer=n,this.torusIframe=o,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});const{currentLoginProvider:i,isLoggedIn:a}=await this.request({method:sl,params:[]});this._handleConnect(i,a)}catch(t){vl.error("Torus: Failed to get initial state. Please report this bug.",t)}finally{vl.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(e){let{url:t,target:r,features:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=new URL(t||"".concat(this.torusUrl,"/redirect?windowId=").concat(e));this.dappStorageKey&&(o.hash?o.hash+="&dappStorageKey=".concat(this.dappStorageKey):o.hash="#dappStorageKey=".concat(this.dappStorageKey));const i=new jl({url:o,target:r,features:n});i.open(),i.window?(this.windowRefs[e]=i,this.request({method:"opened_window",params:{windowId:e}}),i.once("close",()=>{delete this.windowRefs[e],this.request({method:al,params:{windowId:e}})})):this._createPopupBlockAlert(e,o.href)}_displayIframe(){let{isFull:e=!1,rid:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r={};if(e)r.display="block",r.width="100%",r.height="100%",r.top="0px",r.right="0px",r.left="0px",r.bottom="0px";else switch(r.display=this._state.torusWidgetVisibility?"block":"none",r.height="70px",r.width="70px",this._state.buttonPosition){case wl.TOP_LEFT:r.top="0px",r.left="0px",r.right="auto",r.bottom="auto";break;case wl.TOP_RIGHT:r.top="0px",r.right="0px",r.left="auto",r.bottom="auto";break;case wl.BOTTOM_RIGHT:r.bottom="0px",r.right="0px",r.top="auto",r.left="auto";break;case wl.BOTTOM_LEFT:default:r.bottom="0px",r.left="0px",r.top="auto",r.right="auto"}Object.assign(this.torusIframe.style,r),this._state.isIFrameFullScreen=e,this.request({method:il,params:{isIFrameFullScreen:e,rid:t}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(e,t){const r=t,n=e;Array.isArray(n)||n.jsonrpc||(n.jsonrpc="2.0"),this.tryWindowHandle(n,r)}_handleConnect(e,t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:e,isLoggedIn:t}),vl.debug(yl.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new u.EthereumRpcError(1013,t||bl.disconnected()),vl.debug(r)):(r=new u.EthereumRpcError(1011,t||bl.permanentlyDisconnected()),vl.error(r),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleCloseWindow(e){const{windowId:t}=e;this.windowRefs[t]&&(this.windowRefs[t].close(),delete this.windowRefs[t])}async _createPopupBlockAlert(e,t){const r=this.getLogoUrl(),n=Pl('<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="'.concat(r,'" /></div><div><h1 id="torusAlert__title">').concat(this.embedTranslations.actionRequired,'</h1><p id="torusAlert__desc">').concat(this.embedTranslations.pendingAction,"</p></div></div>")),o=Pl('<div><a id="torusAlert__btn">'.concat(this.embedTranslations.continue,"</a></div>")),i=Pl('<div id="torusAlert__btn-container"></div>');i.appendChild(o),n.appendChild(i);(()=>{this.torusAlertContainer.appendChild(n)})(),(()=>{o.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:xl(Tl)}),n.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")})})(),this.torusAlertContainer.style.display="block"}getLogoUrl(){return"".concat(this.torusUrl,"/images/torus_icon-blue.svg")}}W(Ll,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class Nl extends Ol{constructor(e,t){let{maxEventListeners:r=100,jsonRpcStreamName:n="provider"}=t;super(e,{maxEventListeners:r,jsonRpcStreamName:n}),W(this,"chainId",void 0),W(this,"selectedAddress",void 0),W(this,"tryWindowHandle",void 0),this._state=q({},Nl._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0});this.jsonRpcConnectionEvents.on("notification",e=>{const{method:t,params:r}=e;t===cl?this._handleAccountsChanged(r):t===dl?this._handleUnlockStateChanged(r):t===ul&&this._handleChainChanged(r)})}isConnected(){return this._state.isConnected}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:r}=await this.request({method:ll,params:[]});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){vl.error("Torus: Failed to get initial state. Please report this bug.",e)}finally{vl.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t;const o=e;if(!Array.isArray(o))if(o.jsonrpc||(o.jsonrpc="2.0"),"solana_accounts"===o.method||"solana_requestAccounts"===o.method)n=(e,n)=>{this._handleAccountsChanged(n.result||[],"solana_accounts"===o.method,r),t(e,n)};else if("wallet_getProviderState"===o.method)return void this._rpcEngine.handle(e,n);this.tryWindowHandle(o,n)}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),vl.debug(yl.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new u.EthereumRpcError(1013,t||bl.disconnected()),vl.debug(r)):(r=new u.EthereumRpcError(1011,t||bl.permanentlyDisconnected()),vl.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleAccountsChanged(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;Array.isArray(n)||(vl.error("Torus: Received non-array accounts parameter. Please report this bug.",n),n=[]);for(const o of e)if("string"!=typeof o){vl.error("Torus: Received non-string account. Please report this bug.",e),n=[];break}hl(this._state.accounts,n)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&vl.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',n),this._state.accounts=n,this.emit("accountsChanged",n)),this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null)}_handleChainChanged(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e?"loading"===e?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId))):vl.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:e})}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"boolean"==typeof t?t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[])):vl.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t})}}function Cl(e){return new Promise((t,r)=>{try{const r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(n){r(n)}})}W(Nl,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const Bl=e=>{const{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;const n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function Ml(e){try{const{document:t}=e;let r=t.querySelector('head > link[rel="shortcut icon"]');return r&&await Cl(r.href)||(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(e=>!!e.href),r&&await Cl(r.href))?r.href:""}catch(t){return""}}const Dl=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],Ul=[nl],Wl=function(e){let t;try{t=window[e];const r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(r){const e=r;return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}("localStorage");!async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await Sl("production");e.href="".concat(t,"/frame"),e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){vl.warn(e)}}();class Fl{constructor(){let{modalZIndex:e=99999}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};W(this,"isInitialized",void 0),W(this,"torusAlert",void 0),W(this,"modalZIndex",void 0),W(this,"alertZIndex",void 0),W(this,"requestedLoginProvider",void 0),W(this,"provider",void 0),W(this,"communicationProvider",void 0),W(this,"dappStorageKey",void 0),W(this,"isTopupHidden",!1),W(this,"torusAlertContainer",void 0),W(this,"torusUrl",void 0),W(this,"torusIframe",void 0),W(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=e,this.alertZIndex=e+1e3,this.dappStorageKey=""}get isLoggedIn(){return!!this.communicationProvider&&this.communicationProvider.isLoggedIn}async init(){let{buildEnv:e=ml.PRODUCTION,enableLogging:t=!1,network:r,showTorusButton:n=!1,useLocalStorage:o=!1,buttonPosition:i=wl.BOTTOM_LEFT,apiKey:a="torus-default",extraParams:s={},whiteLabel:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:c,logLevel:u}=await Sl(e);vl.enableAll(),vl.info(c,"url loaded"),vl.info("Solana Embed Version :".concat("2.1.0")),this.torusUrl=c,vl.setDefaultLevel(u),t?vl.enableAll():vl.disableAll();const d=this.handleDappStorageKey(o),f=new URL(c);f.pathname.endsWith("/")?f.pathname+="frame":f.pathname+="/frame";const h=new URLSearchParams;return d&&h.append("dappStorageKey",d),h.append("origin",window.location.origin),f.hash=h.toString(),this.torusIframe=Pl('<iframe\n        id="torusIframe"\n        class="torusIframe"\n        src="'.concat(f.href,'"\n        style="display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ').concat(this.modalZIndex.toString(),'"\n      ></iframe>')),this.torusAlertContainer=Pl('<div id="torusAlertContainer" style="display:none; z-index: '.concat(this.alertZIndex.toString(),'"></div>')),this.styleLink=Pl('<link href="'.concat(c,'/css/widget.css" rel="stylesheet" type="text/css">')),new Promise((e,t)=>{try{this.torusIframe.addEventListener("load",async()=>{const t=await(async()=>({name:Bl(window),icon:await Ml(window)}))();this.torusIframe.contentWindow.postMessage({buttonPosition:i,apiKey:a,network:r,dappMetadata:t,extraParams:s,whiteLabel:l},f.origin),await this._setupWeb3({torusUrl:c}),n&&this.showTorusButton(),null!=l&&l.topupHide?this.isTopupHidden=l.topupHide:this.hideTorusButton(),this.isInitialized=!0,window.torus=this,e()}),window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}catch(o){t(o)}})}async login(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");try{this.requestedLoginProvider=e.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});const t=await new Promise((t,r)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,e.login_hint]},qi(t,r))});if(Array.isArray(t)&&t.length>0)return t;throw new Error("Login failed")}catch(t){throw vl.error("login failed",t),t}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(e){if(!this.isInitialized)throw new Error("Call init() first");const{privateKey:t,userInfo:r}=e,{success:n}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:t,userInfo:r}});if(!n)throw new Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:el,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(e){return e instanceof Element||e instanceof Document}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(e){await this.communicationProvider.request({method:nl,params:q({},e)})}async showWallet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await this.communicationProvider.request({method:tl,params:[]}),n=e?"/".concat(e):"",o=new URL("".concat(this.torusUrl,"/wallet").concat(n));o.searchParams.append("instanceId",r),Object.keys(t).forEach(e=>{o.searchParams.append(e,t[e])}),this.dappStorageKey&&(o.hash="#dappStorageKey=".concat(this.dappStorageKey)),new jl({url:o,features:xl(Rl)}).open()}async getUserInfo(){return await this.communicationProvider.request({method:rl,params:[]})}async initiateTopup(e,t){if(!this.isInitialized)throw new Error("Torus is not initialized");const r=El();return this.communicationProvider._handleWindow(r),await this.communicationProvider.request({method:ol,params:{provider:e,params:t,windowId:r}})}async getAccounts(){return await this.provider.request({method:"getAccounts",params:[]})}async sendTransaction(e){const t=kl(e),r=t?e.serialize({requireAllSignatures:!1}).toString("hex"):l.d.Buffer.from(e.serialize()).toString("hex");return await this.provider.request({method:"send_transaction",params:{message:r,isLegacyTransaction:t}})}async signAndSendTransaction(e,t){const r=kl(e),n=r?e.serialize({requireAllSignatures:!1}).toString("hex"):l.d.Buffer.from(e.serialize()).toString("hex");return{signature:await this.provider.request({method:"send_transaction",params:{message:n,options:t,isLegacyTransaction:r}})}}async signTransaction(e){const t=kl(e),r=t?e.serializeMessage().toString("hex"):l.d.Buffer.from(e.message.serialize()).toString("hex"),n=await this.provider.request({method:"sign_transaction",params:{message:r,messageOnly:!0,isLegacyTransaction:t}}),o=JSON.parse(n),i={publicKey:new l.af(o.publicKey),signature:l.d.Buffer.from(o.signature,"hex")};return e.addSignature(i.publicKey,i.signature),e}async signAllTransactions(e){let t;const r=e.map(e=>(t=kl(e),t?e.serializeMessage().toString("hex"):l.d.Buffer.from(e.message.serialize()).toString("hex"))),n=(await this.provider.request({method:"sign_all_transactions",params:{message:r,messageOnly:!0,isLegacyTransaction:t}})).map(e=>{const t=JSON.parse(e);return{publicKey:new l.af(t.publicKey),signature:l.d.Buffer.from(t.signature,"hex")}});return e.forEach((e,t)=>(e.addSignature(n[t].publicKey,n[t].signature),e)),e}async signMessage(e){return await this.provider.request({method:"sign_message",params:{data:e}})}async getGaslessPublicKey(){return await this.provider.request({method:"get_gasless_public_key",params:[]})}handleDappStorageKey(e){const t="".concat(_l.localStorageKeyPrefix).concat(window.location.hostname);let r="";if(Wl&&e){const e=window.localStorage.getItem(t);if(e)r=e;else{const e="torus-app-".concat(El());window.localStorage.setItem(t,e),r=e}}return this.dappStorageKey=r,r}async _setupWeb3(e){vl.info("setupWeb3 running");const t=new Ti({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),r=new Ti({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),n=new Nl(t,{}),o=new Ll(r,{});n.tryWindowHandle=(e,t)=>{const r=e;if(!Array.isArray(r)&&Dl.includes(r.method)){if(!this.communicationProvider.isLoggedIn)throw new Error("User Not Logged In");const e=El();o._handleWindow(e,{target:"_blank",features:xl(Tl)}),r.windowId=e}n._rpcEngine.handle(r,t)},o.tryWindowHandle=(e,t)=>{const r=e;if(!Array.isArray(r)&&Ul.includes(r.method)){const e=El();o._handleWindow(e,{target:"_blank",features:xl(Al)}),r.params.windowId=e}o._rpcEngine.handle(r,t)};const i=e=>{const t=n[e],r=this;n[e]=function(e,n){const{method:o,params:i=[]}=e;if("solana_requestAccounts"===o){if(!n)return r.login({loginProvider:i[0]});r.login({loginProvider:i[0]}).then(e=>n(null,e)).catch(e=>n(e))}return t.apply(this,[e,n])}};i("request"),i("sendAsync"),i("send");const a=new Proxy(n,{deleteProperty:()=>!0}),s=new Proxy(o,{deleteProperty:()=>!0});this.provider=a,this.communicationProvider=s,await Promise.all([n._initializeState(),o._initializeState(q(q({},e),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),vl.debug("Torus - injected provider")}}},6118:(e,t,r)=>{r.d(t,{j:()=>i});class n extends Error{}function o(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}(t)}catch(r){return atob(t)}}function i(e,t){if("string"!=typeof e)throw new n("Invalid token specified: must be a string");t||(t={});const r=!0===t.header?0:1,i=e.split(".")[r];if("string"!=typeof i)throw new n("Invalid token specified: missing part #".concat(r+1));let a;try{a=o(i)}catch(s){throw new n("Invalid token specified: invalid base64 for part #".concat(r+1," (").concat(s.message,")"))}try{return JSON.parse(a)}catch(s){throw new n("Invalid token specified: invalid json for part #".concat(r+1," (").concat(s.message,")"))}}n.prototype.name="InvalidTokenError"}}]);
//# sourceMappingURL=5577.9eb4064f.chunk.js.map