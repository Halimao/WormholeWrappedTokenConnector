"use strict";(self.webpackChunkwormhole_connector=self.webpackChunkwormhole_connector||[]).push([[1083],{1083:(t,e,n)=>{n.r(e),n.d(e,{EvmTBTCBridge:()=>T});var r=n(600),a=n(6218),i=n(8951),o=n(9495),s=n(7547),c=n(3402),d=n(376),h=n(200),w=n(4230),l=n(9801),p=Object.defineProperty,u=(t,e,n)=>((t,e,n)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);class T{constructor(t,e,n,r){if(u(this,"network"),u(this,"chain"),u(this,"provider"),u(this,"contracts"),u(this,"chainId"),u(this,"core"),u(this,"gatewayAddress"),u(this,"gateway"),u(this,"tbtcTokenAddr"),this.network=t,this.chain=e,this.provider=n,this.contracts=r,"Mainnet"!==this.network)throw new Error("TBTC is only supported on Mainnet");if(!this.contracts.tbtc)throw new Error("TBTC contract address is required");const a=s.I.getNativeTbtcToken(this.chain);if(!a)throw new Error("Native tbtc token not found");this.chainId=s.ac.get(t,e),this.core=new c.EvmWormholeCore(t,e,n,r),this.gatewayAddress=this.contracts.tbtc,this.gateway=new d.C(this.gatewayAddress,["function sendTbtc(uint256 amount, uint16 recipientChain, bytes32 recipient, uint256 arbiterFee, uint32 nonce) payable returns (uint64)","function receiveTbtc(bytes calldata encodedVm)"],n),this.tbtcTokenAddr=(0,s.q)(a)}static async fromRpc(t,e){const[n,r]=await h.E.chainFromRpc(t),a=e[r];if(a.network!==n)throw new Error("Network mismatch: ".concat(a.network," != ").concat(n));return new T(n,r,t,a.contracts)}transfer(t,e,n){var c=this;return(0,r.A)(function*(){const r=new s.aR(t).toString(),d=yield(0,a.A)(c.gateway.sendTbtc.populateTransaction(n,(0,s.aP)(e.chain),e.address.toUniversalAddress().toUint8Array(),0n,0n));d.value=yield(0,a.A)(c.core.getMessageFee()),yield*(0,i.A)((0,o.A)(c.approve(r,n,c.gatewayAddress)),a.A),yield c.createUnsignedTransaction((0,s.aU)(d,r),"TBTCBridge.Send")})()}redeem(t,e){var n=this;return(0,r.A)(function*(){if("GatewayTransfer"!==e.payloadName)throw new Error("Invalid VAA payload");const r=new s.aR(t).toString(),i=yield(0,a.A)(n.gateway.receiveTbtc.populateTransaction((0,s.L)(e)));yield n.createUnsignedTransaction((0,s.aU)(i,r),"TBTCBridge.Redeem")})()}approve(t,e,n){var i=this;return(0,r.A)(function*(){const r=h.E.getTokenImplementation(i.provider,i.tbtcTokenAddr);if((yield(0,a.A)(r.allowance(t,n)))<e){const o=yield(0,a.A)(r.approve.populateTransaction(n,e));yield i.createUnsignedTransaction((0,s.aU)(o,t),"TBTC.Approve")}})()}createUnsignedTransaction(t,e){return new w.E((0,s.aV)(t,this.chainId),this.network,this.chain,e,!1)}}(0,l.r)(s.aW,"TBTCBridge",T)}}]);
//# sourceMappingURL=1083.48f9c0a0.chunk.js.map