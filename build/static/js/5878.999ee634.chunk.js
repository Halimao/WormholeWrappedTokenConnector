"use strict";(self.webpackChunkwormhole_connector=self.webpackChunkwormhole_connector||[]).push([[5878],{2126:(e,t,n)=>{n.d(t,{A:()=>s});var r=Object.defineProperty,a=(e,t,n)=>((e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class s{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];a(this,"transaction"),a(this,"network"),a(this,"chain"),a(this,"description"),a(this,"parallelizable"),this.transaction=e,this.network=t,this.chain=n,this.description=r,this.parallelizable=s}}},5878:(e,t,n)=>{n.r(t),n.d(t,{AptosCircleBridge:()=>h});var r=n(600),a=n(6045),s=n(7547),c=n(3332),i=n(2126),o=n(9801),d=Object.defineProperty,f=(e,t,n)=>((e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const b=(0,s.a1)([["Mainnet",{depositForBurn:"0xa11ceb0b0700000a0701000802080e031614042a04052e30075e870108e5014000000001000201030004000001050701000100060b0001070304010801020805060108010309080900010002010205060c030e05050208000b010108020108020105010b0101090003060c0b01010900030108000004060c08000e0501030e66756e6769626c655f6173736574066f626a656374167072696d6172795f66756e6769626c655f73746f72650f746f6b656e5f6d657373656e6765720d46756e6769626c654173736574064f626a656374084d6574616461746111616464726573735f746f5f6f626a656374087769746864726177106465706f7369745f666f725f6275726e00000000000000000000000000000000000000000000000000000000000000019bce6734f7b63e835108e3bd8c36743d4709fe435f44791918801d0989640a9d0000010f0b0438000c060a000b060b0138010c050b000b050b020b0311020102",handleReceiveMessage:"0xa11ceb0b0700000a0601000402040403080c051416072a53087d40000001010002000000030203000101040304000103060c0a020a020003060c060a02060a020108000101136d6573736167655f7472616e736d69747465720f746f6b656e5f6d657373656e67657207526563656970740f726563656976655f6d6573736167651668616e646c655f726563656976655f6d657373616765177e17751820e4b4371873ca8c30279be63bdea63b88ed0f2239c2eea10f17729bce6734f7b63e835108e3bd8c36743d4709fe435f44791918801d0989640a9d000001070b000e010e02110011010102"}],["Testnet",{depositForBurn:"0xa11ceb0b0700000a0701000802080e031614042a04052e30075e870108e5014000000001000201030004000001050701000100060b0001070304010801020805060108010309080900010002010205060c030e05050208000b010108020108020105010b0101090003060c0b01010900030108000004060c08000e0501030e66756e6769626c655f6173736574066f626a656374167072696d6172795f66756e6769626c655f73746f72650f746f6b656e5f6d657373656e6765720d46756e6769626c654173736574064f626a656374084d6574616461746111616464726573735f746f5f6f626a656374087769746864726177106465706f7369745f666f725f6275726e00000000000000000000000000000000000000000000000000000000000000015f9b937419dda90aa06c1836b7847f65bbbe3f1217567758dc2488be31a477b90000010f0b0438000c060a000b060b0138010c050b000b050b020b0311020102",handleReceiveMessage:"0xa11ceb0b0700000a0601000402040403080c051416072a53087d40000001010002000000030203000101040304000103060c0a020a020003060c060a02060a020108000101136d6573736167655f7472616e736d69747465720f746f6b656e5f6d657373656e67657207526563656970740f726563656976655f6d6573736167651668616e646c655f726563656976655f6d657373616765081e86cebf457a0c6004f35bd648a2794698f52e0dde09a48619dcd3d4cc23d95f9b937419dda90aa06c1836b7847f65bbbe3f1217567758dc2488be31a477b9000001070b000e010e02110011010102"}]],[0,1]);class h{constructor(e,t,n,r){var a,c,i;if(f(this,"network"),f(this,"chain"),f(this,"provider"),f(this,"contracts"),f(this,"usdcId"),f(this,"tokenMessengerId"),f(this,"messageTransmitterId"),f(this,"moveScripts"),this.network=e,this.chain=t,this.provider=n,this.contracts=r,"Devnet"===e)throw new Error("CircleBridge not supported on Devnet");const o=s.D.get(this.network,this.chain);if(!o)throw new Error("No USDC contract configured for network=".concat(this.network," chain=").concat(this.chain));if(null==(a=r.cctp)||!a.tokenMessenger)throw new Error("Circle Token Messenger contract for domain ".concat(t," not found"));if(null==(c=r.cctp)||!c.messageTransmitter)throw new Error("Circle Message Transmitter contract for domain ".concat(t," not found"));if(!b.has(e))throw new Error("No Aptos CCTP move scripts found");this.usdcId=o,this.tokenMessengerId=null==(i=r.cctp)?void 0:i.tokenMessenger,this.messageTransmitterId=r.cctp.messageTransmitter,this.moveScripts=b.get(e)}transfer(e,t,n){var c=this;return(0,r.A)(function*(){const e=new a.y(s.be.get(c.network,t.chain)),r=a.l.from(c.usdcId),i=a.l.from(t.address.toUniversalAddress().toUint8Array()),o=[new a.w(n),e,i,r],d={bytecode:c.moveScripts.depositForBurn,functionArguments:o};yield c.createUnsignedTx(d,"Aptos.CircleBridge.Transfer")})()}async isTransferCompleted(e){const t=new a.y(e.sourceDomain).bcsToBytes(),n=new a.w(e.nonce).bcsToBytes(),r=(0,s.aO)(new Uint8Array([...t,45,...n])),c=s.a3.encode(r);return(await this.provider.view({payload:{function:"".concat(this.messageTransmitterId,"::message_transmitter::is_nonce_used"),functionArguments:[c]}}))[0]}redeem(e,t,n){var c=this;return(0,r.A)(function*(){const e=[a.x.U8(s.G.serialize(t)),a.x.U8(s.a3.decode(n))],r={bytecode:c.moveScripts.handleReceiveMessage,functionArguments:e};yield c.createUnsignedTx(r,"Aptos.CircleBridge.Redeem")})()}async parseTransactionDetails(e){var t;const n=await this.provider.getTransactionByHash({transactionHash:e}),r=this.messageTransmitterId.replace(/^0x0+/,"0x"),a=null==(t=n.events)?void 0:t.find(e=>e.type==="".concat(r,"::message_transmitter::MessageSent"));if(!a)throw new Error("No MessageSent event found");const c=s.a3.decode(a.data.message),[i,o]=s.G.deserialize(c),{payload:d}=i,f=d.messageSender,b=d.mintRecipient,h=(0,s.d8)(this.network,i.sourceDomain);return{from:{chain:h,address:f},to:{chain:(0,s.d8)(this.network,i.destinationDomain),address:b},token:{chain:h,address:d.burnToken},amount:d.amount,message:i,id:{hash:o}}}static async fromRpc(e,t){const[n,r]=await c.A.chainFromRpc(e),a=t[r];if(a.network!==n)throw new Error("Network mismatch: ".concat(a.network," != ").concat(n));return new h(n,r,e,a.contracts)}createUnsignedTx(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new i.A(e,this.network,this.chain,t,n)}}(0,o.r)("Aptos","CircleBridge",h)}}]);
//# sourceMappingURL=5878.999ee634.chunk.js.map